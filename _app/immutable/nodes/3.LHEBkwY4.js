import{a as l,f,c as X,b as tt}from"../chunks/_V9dK3ok.js";import{o as Ct}from"../chunks/1hPTKaIJ.js";import{p as Lt,b as I,d as $t,u as Mt,g as t,e as p,t as h,a as zt,s as d,c as o,r as e,h as G,f as Y}from"../chunks/CcVkWGgp.js";import{d as Bt,s as w}from"../chunks/Dap9sqf4.js";import{i as u}from"../chunks/BSGnc2-w.js";import{e as Rt,i as It}from"../chunks/GjfVCmik.js";import{a as T,s as Tt}from"../chunks/By8uYFO7.js";import{s as j}from"../chunks/DObsSMuQ.js";import{s as jt,a as Z}from"../chunks/Dn1l8nLM.js";import{g as H}from"../chunks/mFQhxeed.js";import{b as J}from"../chunks/BukajRYZ.js";import{a as K}from"../chunks/BSj9hSjl.js";import{i as Ft,u as Pt}from"../chunks/3jTL0Oy-.js";import{L as St}from"../chunks/Crjibkup.js";var qt=f("<span> </span>"),At=f('<div class="flex gap-1 mb-6 border-b border-gray-200"><button><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg> 내 과정 <!></button> <button>전체 보기 <span> </span></button></div>'),Dt=f('<div class="text-center py-12 text-gray-500"><p class="mb-4">등록된 과정이 없습니다.</p> <p class="text-sm">위의 "과정 동기화" 버튼을 눌러 Legacy 시스템에서 과정을 가져오세요.</p></div>'),Et=f('<div class="text-center py-12 text-gray-500"><p class="mb-2">즐겨찾기한 과정이 없습니다.</p> <p class="text-sm">과정 카드의 ★ 버튼으로 즐겨찾기를 추가하거나, "전체 보기" 탭에서 과정을 확인하세요.</p></div>'),Gt=f('<span class="px-2 py-0.5 bg-purple-50 text-purple-600 rounded"> </span>'),Ht=f('<span class="px-2 py-0.5 bg-gray-100 text-gray-600 rounded"> </span>'),Jt=f('<span class="px-2 py-0.5 bg-green-50 text-green-600 rounded">활성</span>'),Kt=tt('<svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>'),Nt=tt('<svg class="w-5 h-5 text-gray-300 hover:text-yellow-400" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>'),Ot=f('<div class="relative bg-white rounded-lg border border-gray-200 hover:shadow-md hover:border-blue-300 transition-all"><button class="w-full p-5 text-left cursor-pointer"><h2 class="font-semibold text-gray-800 mb-2 pr-8"> </h2> <div class="flex flex-wrap gap-2 text-xs"><!> <!> <!></div></button> <button class="absolute top-3 right-3 p-1.5 rounded-full hover:bg-yellow-50 transition-colors cursor-pointer"><!></button></div>'),Qt=f('<div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3"></div>'),Ut=f('<div class="max-w-6xl mx-auto px-3 py-6 sm:px-6"><div class="flex items-center justify-between mb-4"><h1 class="text-2xl font-bold text-gray-800">과정 관리</h1> <button class="px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors cursor-pointer"> </button></div> <!> <!></div>');function vr(rt,at){Lt(at,!0);const et=()=>Z(Ft,"$isLoggedIn",N),ot=()=>Z(Pt,"$userRole",N),[N,st]=jt();let k=I(!0),$=I(!1),g=I($t([])),_=I("favorites"),M=G(()=>[...t(g)].filter(r=>r.is_favorite).sort((r,s)=>r.name.localeCompare(s.name))),lt=G(()=>[...t(g)].sort((r,s)=>r.is_favorite!==s.is_favorite?r.is_favorite?-1:1:r.name.localeCompare(s.name))),O=G(()=>t(_)==="favorites"?t(M):t(lt));Mt(()=>{!t(k)&&t(M).length===0&&p(_,"all")}),Ct(async()=>{if(!et()){H(`${J}/login`);return}if(ot()!=="facilitator"){H(`${J}/student`);return}await it()});async function it(){p(k,!0);try{p(g,await K.get("/api/v1/facilitator/courses"),!0)}catch{T("과정 목록을 불러올 수 없습니다.","error")}finally{p(k,!1)}}async function nt(){p($,!0);try{p(g,await K.post("/api/v1/admin/sync/courses"),!0),T("과정 목록이 동기화되었습니다.","success")}catch{T("과정 동기화에 실패했습니다.","error")}finally{p($,!1)}}async function vt(r,s){r.stopPropagation();try{const v=await K.post(`/api/v1/facilitator/courses/${s}/favorite`);p(g,t(g).map(b=>b.legacy_course_id===s?{...b,is_favorite:v.is_favorite}:b),!0)}catch{T("즐겨찾기 변경에 실패했습니다.","error")}}var F=Ut(),P=o(F),z=d(o(P),2);z.__click=nt;var ct=o(z,!0);e(z),e(P);var Q=d(P,2);{var pt=r=>{var s=At(),v=o(s);v.__click=()=>p(_,"favorites");var b=d(o(v),2);{var S=C=>{var y=qt(),x=o(y,!0);e(y),h(()=>{j(y,1,`px-1.5 py-0.5 text-xs rounded-full ${t(_)==="favorites"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-500"}`),w(x,t(M).length)}),l(C,y)};u(b,C=>{t(M).length>0&&C(S)})}e(v);var n=d(v,2);n.__click=()=>p(_,"all");var m=d(o(n)),q=o(m,!0);e(m),e(n),e(s),h(()=>{j(v,1,`flex items-center gap-1.5 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors cursor-pointer ${t(_)==="favorites"?"border-yellow-400 text-yellow-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`),j(n,1,`flex items-center gap-1.5 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors cursor-pointer ${t(_)==="all"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`),j(m,1,`px-1.5 py-0.5 text-xs rounded-full ${t(_)==="all"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-500"}`),w(q,t(g).length)}),l(r,s)};u(Q,r=>{!t(k)&&t(g).length>0&&r(pt)})}var dt=d(Q,2);{var ft=r=>{St(r,{type:"card",lines:4})},gt=r=>{var s=X(),v=Y(s);{var b=n=>{var m=Dt();l(n,m)},S=n=>{var m=X(),q=Y(m);{var C=x=>{var L=Et();l(x,L)},y=x=>{var L=Qt();Rt(L,21,()=>t(O),It,(ut,c)=>{var A=Ot(),B=o(A);B.__click=()=>H(`${J}/facilitator/courses/${t(c).legacy_course_id}`);var D=o(B),_t=o(D,!0);e(D);var U=d(D,2),V=o(U);{var mt=a=>{var i=Gt(),E=o(i,!0);e(i),h(()=>w(E,t(c).cohort)),l(a,i)};u(V,a=>{t(c).cohort&&a(mt)})}var W=d(V,2);{var xt=a=>{var i=Ht(),E=o(i,!0);e(i),h(()=>w(E,t(c).category)),l(a,i)};u(W,a=>{t(c).category&&a(xt)})}var bt=d(W,2);{var yt=a=>{var i=Jt();l(a,i)};u(bt,a=>{t(c).is_active&&a(yt)})}e(U),e(B);var R=d(B,2);R.__click=a=>vt(a,t(c).legacy_course_id);var ht=o(R);{var wt=a=>{var i=Kt();l(a,i)},kt=a=>{var i=Nt();l(a,i)};u(ht,a=>{t(c).is_favorite?a(wt):a(kt,!1)})}e(R),e(A),h(()=>{w(_t,t(c).name),Tt(R,"title",t(c).is_favorite?"즐겨찾기 해제":"즐겨찾기 추가")}),l(ut,A)}),e(L),l(x,L)};u(q,x=>{t(O).length===0?x(C):x(y,!1)},!0)}l(n,m)};u(v,n=>{t(g).length===0?n(b):n(S,!1)},!0)}l(r,s)};u(dt,r=>{t(k)?r(ft):r(gt,!1)})}e(F),h(()=>{z.disabled=t($),w(ct,t($)?"동기화 중...":"과정 동기화")}),l(rt,F),zt(),st()}Bt(["click"]);export{vr as component};
