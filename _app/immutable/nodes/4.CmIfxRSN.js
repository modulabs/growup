import{a as d,f as v,c as he}from"../chunks/wpWHR9Sb.js";import{o as ta}from"../chunks/D988khm2.js";import{l as ea,an as ra,aj as aa,a1 as sa,ao as la,ap as oa,n as we,o as ia,p as na,b as u,d as It,f as dt,t as m,g as t,a as da,e as l,c as r,s,h as tr,q as ke,r as e}from"../chunks/CchEtKBU.js";import{d as ua,s as n,e as va}from"../chunks/YWCZP22E.js";import{i as $}from"../chunks/CoOWwNBS.js";import{e as W,i as Y}from"../chunks/BDY2RkGR.js";import{a as y,r as H,b as er,s as ca}from"../chunks/CAucnRVX.js";import{s as Lt,c as pa}from"../chunks/DceYZvc6.js";import{L as Se,s as _a}from"../chunks/AcFXWFEl.js";import{b as Z}from"../chunks/DN98pmxQ.js";import{s as xa,a as fa}from"../chunks/CJsAfNP2.js";import{p as ba}from"../chunks/CN8zeNpY.js";import{g as $e}from"../chunks/DDNBaIbs.js";import{b as Ie}from"../chunks/CpycODcz.js";import{a as C}from"../chunks/P1I26QL0.js";import{i as ga}from"../chunks/BanGi3_-.js";import{Q as rr}from"../chunks/DqiXTygU.js";function ar(c,q,rt=!1){if(c.multiple){if(q==null)return;if(!sa(q))return la();for(var G of c.options)G.selected=q.includes(Dt(G));return}for(G of c.options){var J=Dt(G);if(oa(J,q)){G.selected=!0;return}}(!rt||q!==void 0)&&(c.selectedIndex=-1)}function ma(c){var q=new MutationObserver(()=>{ar(c,c.__value)});q.observe(c,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),aa(()=>{q.disconnect()})}function Le(c,q,rt=q){var G=new WeakSet,J=!0;ea(c,"change",A=>{var D=A?"[selected]":":checked",k;if(c.multiple)k=[].map.call(c.querySelectorAll(D),Dt);else{var K=c.querySelector(D)??c.querySelector("option:not([disabled])");k=K&&Dt(K)}rt(k),we!==null&&G.add(we)}),ra(()=>{var A=q();if(c===document.activeElement){var D=ia??we;if(G.has(D))return}if(ar(c,A,J),J&&A===void 0){var k=c.querySelector(":checked");k!==null&&(A=Dt(k),rt(A))}c.__value=A,J=!1}),ma(c)}function Dt(c){return"__value"in c?c.__value:c.value}var ya=v('<div class="text-center py-12 text-gray-500"><p class="mb-4">ë“±ë¡ëœ í€˜ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p> <p class="text-sm">ìœ„ì˜ "+ í€˜ìŠ¤íŠ¸ ì¶”ê°€" ë²„íŠ¼ìœ¼ë¡œ í€˜ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ì„¸ìš”.</p></div>'),ha=v('<button class="px-3 py-1.5 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors cursor-pointer"> </button>'),wa=v('<div class="w-16 h-1.5 bg-gray-200 rounded-full overflow-hidden"><div></div></div>'),ka=v('<div class="bg-white p-3 rounded border border-gray-200 text-sm text-gray-600 mb-3"> </div>'),Sa=v('<tr><td class="py-2 pr-2 text-gray-700 font-medium"> </td><td class="py-2 text-center text-gray-600"> </td><td class="py-2 text-center text-purple-600"> </td><td class="py-2 pl-2 text-gray-500"> </td></tr>'),$a=v('<div class="bg-gray-50 rounded-lg border border-gray-200 p-4"><div class="flex justify-between items-start mb-3"><h4 class="font-medium text-gray-900"> </h4> <div class="flex gap-2"><span class="text-xs font-bold bg-white border border-gray-200 px-2 py-1 rounded text-gray-600"> </span> <span class="text-xs font-bold bg-purple-100 border border-purple-200 px-2 py-1 rounded text-purple-700"> </span></div></div> <!> <table class="w-full text-xs"><thead><tr class="text-gray-500 border-b border-gray-200"><th class="py-2 text-left">í•­ëª©</th><th class="py-2 text-center w-10">H</th><th class="py-2 text-center w-10">G</th><th class="py-2 text-left">í”¼ë“œë°±</th></tr></thead><tbody class="divide-y divide-gray-200"></tbody></table></div>'),Ia=v('<h3 class="font-medium text-purple-800 mb-4 flex items-center gap-2"><span class="w-2 h-6 bg-purple-600 rounded-full"></span> LMS ë£¨ë¸Œë¦­ í‰ê°€</h3> <div class="space-y-6"></div>',1),La=v('<div class="text-center py-12 text-gray-500 bg-gray-50 rounded-lg border border-gray-200 border-dashed"><p>ë£¨ë¸Œë¦­ í‰ê°€ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>'),Da=v('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4"><div class="bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col"><div class="p-5 border-b border-gray-200 flex justify-between items-center"><h2 class="text-lg font-bold text-gray-800"> </h2> <button class="text-gray-400 hover:text-gray-600 p-1">âœ•</button></div> <div class="p-6 overflow-y-auto"><!></div></div></div>'),Ma=v('<div><div class="flex items-center gap-3 flex-1"><input type="checkbox" class="w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer flex-shrink-0"/> <button class="flex-1 text-left cursor-pointer"><div class="flex items-center gap-3"><span class="text-lg font-bold text-gray-400"> </span> <div><span class="font-medium text-gray-800"> </span> <div class="flex items-center gap-2 mt-1 text-xs"><span class="px-2 py-0.5 bg-blue-50 text-blue-700 rounded"> </span> <span class="text-gray-400"> </span> <span class="text-gray-400">Â·</span> <span> </span> <!> <!></div></div></div></button></div> <div class="flex gap-1 ml-4"><button class="p-2 text-gray-400 hover:text-blue-600 cursor-pointer text-sm">ìˆ˜ì •</button> <button class="p-2 text-gray-400 hover:text-red-600 cursor-pointer text-sm">ì‚­ì œ</button></div></div>'),ja=v('<div class="flex items-center justify-between mb-3 px-1"><label class="flex items-center gap-2 cursor-pointer select-none"><input type="checkbox" class="w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer"/> <span class="text-sm text-gray-600"> </span></label> <!></div> <div class="space-y-3"></div>',1),qa=v("<option> </option>"),za=v("<option> </option>"),Qa=v('<input type="text" placeholder="ì¹´í…Œê³ ë¦¬ ì…ë ¥" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/>'),Ra=v('<div class="text-center py-8 text-gray-400 text-sm">ë¶€ì—¬ëœ ë¹„ì •ê·œ ì ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</div>'),Ta=v('<tr class="hover:bg-gray-50"><td class="px-3 py-2 font-medium text-gray-800 max-w-full lg:max-w-[80px] truncate"> </td><td class="px-3 py-2 text-center font-bold text-green-600"> </td><td class="px-3 py-2 text-xs text-gray-800 max-w-full lg:max-w-[80px] truncate"> </td><td class="px-3 py-2 text-gray-600 max-w-full lg:max-w-[100px] truncate"> </td><td class="px-3 py-2 text-center"><button class="text-red-400 hover:text-red-600 cursor-pointer text-xs">ì‚­ì œ</button></td></tr>'),Ea=v('<div class="bg-white rounded-lg border border-gray-200 overflow-hidden"><div class="max-h-[calc(100vh-400px)] overflow-y-auto"><table class="w-full text-sm"><thead class="bg-gray-50 sticky top-0"><tr><th class="px-3 py-2 text-left text-xs font-medium text-gray-500">í•™ìƒ</th><th class="px-3 py-2 text-center text-xs font-medium text-gray-500">ì ìˆ˜</th><th class="px-3 py-2 text-left text-xs font-medium text-gray-500">ì¹´í…Œê³ ë¦¬</th><th class="px-3 py-2 text-left text-xs font-medium text-gray-500">ì‚¬ìœ </th><th class="px-3 py-2 text-center text-xs font-medium text-gray-500 w-10"></th></tr></thead><tbody class="divide-y divide-gray-100"></tbody></table></div></div>'),Ca=v('<div class="p-4 text-center text-gray-500 text-sm">í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤.</div>'),Aa=v('<li><button class="w-full text-left px-4 py-3 hover:bg-gray-50 flex items-center justify-between group cursor-pointer"><span class="font-medium text-gray-800"> </span> <span class="text-xs text-gray-400 group-hover:text-blue-600">ìƒì„¸ë³´ê¸° &rarr;</span></button></li>'),Ba=v('<ul class="divide-y divide-gray-100"></ul>'),Oa=v('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40"><div class="bg-white rounded-xl shadow-xl w-full max-w-md mx-4 p-6"><h2 class="text-lg font-bold text-gray-800 mb-4"> </h2> <form class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">í€˜ìŠ¤íŠ¸ ë²ˆí˜¸</label> <input type="number" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ìœ í˜•</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"><option>ì„œë¸Œí€˜ìŠ¤íŠ¸ (0~1)</option><option>ë©”ì¸í€˜ìŠ¤íŠ¸ (0~5)</option><option>ë°ì´í„°í†¤ (0~10)</option><option>ì•„ì´ë””ì–´í†¤ (0~20)</option></select></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ì œëª© (ì„ íƒ)</label> <input type="text" placeholder="ì˜ˆ: ë¨¸ì‹ ëŸ¬ë‹ ê¸°ì´ˆ" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ë‚ ì§œ</label> <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div class="flex gap-2 pt-2"><button type="button" class="flex-1 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 cursor-pointer">ì·¨ì†Œ</button> <button type="submit" class="flex-1 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 disabled:opacity-50 cursor-pointer"> </button></div></form></div></div>'),Ua=v("<li> </li>"),Ga=v('<div class="mt-2 pt-2 border-t border-yellow-200"><p class="text-xs font-medium text-yellow-700 mb-1"> </p> <ul class="text-xs text-yellow-600 space-y-0.5 max-h-24 overflow-y-auto"></ul></div>'),Na=v('<div><p>ê°€ì ¸ì˜¤ê¸° ê²°ê³¼</p> <div class="grid grid-cols-2 gap-1 text-xs"><span class="text-gray-600">í€˜ìŠ¤íŠ¸ ìƒì„±:</span> <span class="font-medium"> </span> <span class="text-gray-600">í€˜ìŠ¤íŠ¸ ê°±ì‹ :</span> <span class="font-medium"> </span> <span class="text-gray-600">ì ìˆ˜ ìƒì„±:</span> <span class="font-medium"> </span> <span class="text-gray-600">ì ìˆ˜ ê°±ì‹ :</span> <span class="font-medium"> </span></div> <!></div>'),Ha=v('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40"><div class="bg-white rounded-xl shadow-xl w-full max-w-lg mx-4 p-6"><h2 class="text-lg font-bold text-gray-800 mb-1">ğŸ“¥ ì‹œíŠ¸ì—ì„œ í€˜ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°</h2> <p class="text-xs text-gray-500 mb-4">Google ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì˜ "í€˜ìŠ¤íŠ¸" ì‹œíŠ¸ì—ì„œ í€˜ìŠ¤íŠ¸ ëª©ë¡ê³¼ ì ìˆ˜ë¥¼ ìë™ìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.</p> <div class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">ìŠ¤í”„ë ˆë“œì‹œíŠ¸ URL ë˜ëŠ” ID</label> <input type="text" placeholder="https://docs.google.com/spreadsheets/d/... ë˜ëŠ” ID" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ì‹œíŠ¸ ì´ë¦„</label> <input type="text" placeholder="í€˜ìŠ¤íŠ¸" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500"/> <p class="text-xs text-gray-400 mt-1">ê¸°ë³¸ê°’: "í€˜ìŠ¤íŠ¸"</p></div> <!> <div class="flex gap-2 pt-2"><button type="button" class="flex-1 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 cursor-pointer"> </button> <button type="button" class="flex-1 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 disabled:opacity-50 cursor-pointer"> </button></div></div></div></div>'),Pa=v('<div class="max-w-[1600px] mx-auto px-3 py-6 sm:px-6"><div class="mb-6"><button class="text-sm text-blue-600 hover:text-blue-800 mb-2 cursor-pointer">â† ê³¼ì • ëª©ë¡</button> <h1 class="text-2xl font-bold text-gray-800">í€˜ìŠ¤íŠ¸ ê´€ë¦¬</h1></div> <div class="flex flex-col lg:flex-row gap-6 items-start"><div class="flex-1 min-w-0"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-4"><h2 class="text-lg font-semibold text-gray-700">í€˜ìŠ¤íŠ¸ ëª©ë¡</h2> <div class="flex flex-col sm:flex-row gap-2"><button class="px-3 py-2 text-sm border border-green-600 text-green-700 rounded-lg hover:bg-green-50 transition-colors cursor-pointer">ğŸ“¥ ì‹œíŠ¸ì—ì„œ ê°€ì ¸ì˜¤ê¸°</button> <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer">+ í€˜ìŠ¤íŠ¸ ì¶”ê°€</button></div></div> <!></div> <div class="w-full lg:w-[380px] flex-shrink-0 lg:sticky lg:top-6"><h2 class="text-lg font-semibold text-gray-700 mb-4">ë¹„ì •ê·œ ì ìˆ˜ ê´€ë¦¬</h2> <div class="bg-white rounded-lg border border-gray-200 p-4 mb-4"><h3 class="text-sm font-medium text-gray-700 mb-3">ë¹„ì •ê·œ ì ìˆ˜ ë¶€ì—¬</h3> <div class="space-y-3"><div><label class="block text-xs text-gray-500 mb-1">í•™ìƒ</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"><option>í•™ìƒ ì„ íƒ</option><!></select></div> <div class="flex flex-col sm:flex-row gap-3"><div class="w-20"><label class="block text-xs text-gray-500 mb-1">ì ìˆ˜</label> <input type="number" step="0.5" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div class="flex-1 space-y-2"><div><label class="block text-xs text-gray-500 mb-1">ì¹´í…Œê³ ë¦¬</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></select></div> <!> <div><input type="text" placeholder="ìƒì„¸ ì‚¬ìœ  (ì„ íƒ)" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div></div></div> <button class="w-full px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors cursor-pointer"> </button></div></div> <!></div> <div class="mt-6"><h2 class="text-lg font-semibold text-gray-700 mb-4">í•™ìƒ ëª©ë¡</h2> <div class="bg-white rounded-lg border border-gray-200 overflow-hidden"><div class="max-h-[300px] overflow-y-auto"><!></div></div></div></div></div> <!> <!>',1);function ds(c,q){na(q,!0);const rt=()=>fa(ga,"$isLoggedIn",G),[G,J]=xa();let A=u(!0),D=u(It([])),k=tr(()=>ba.params.courseId),K=u(!1),Mt=u(!1),ut=u(1),vt=u("main"),ct=u(""),pt=u(It(new Date().toISOString().split("T")[0])),X=u(null),I=u(It(new Set)),jt=u(!1),De=tr(()=>t(D).length>0&&t(I).size===t(D).length);function sr(a){const o=new Set(t(I));o.has(a)?o.delete(a):o.add(a),l(I,o,!0)}function lr(){t(De)?l(I,new Set,!0):l(I,new Set(t(D).map(a=>a.id)),!0)}async function or(){if(t(I).size===0)return;const a=t(I).size;if(confirm(`ì„ íƒí•œ ${a}ê°œ í€˜ìŠ¤íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?
ì—°ê´€ëœ ì ìˆ˜ë„ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.`)){l(jt,!0);try{await C.post(`/api/v1/facilitator/courses/${t(k)}/quests/batch-delete`,{quest_ids:[...t(I)]}),y(`${a}ê°œ í€˜ìŠ¤íŠ¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`,"success"),l(I,new Set,!0),await gt()}catch{y("í€˜ìŠ¤íŠ¸ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{l(jt,!1)}}}let Nt=u(!1),_t=u(""),qt=u("í€˜ìŠ¤íŠ¸"),zt=u(!1),M=u(null),Qt=u(It([])),Ht=u(It([])),Pt=u(!1),xt=u(null),ft=u(0),at=u("í¼ì‹¤ì¬ëŸ‰ì ìˆ˜"),Rt=u(""),Tt=u(""),Et=u(!1);const ir=["í¼ì‹¤ì¬ëŸ‰ì ìˆ˜","ì•„ë‚Œì—†ì´ ì£¼ëŠ” ê·¸ë£¨","ë””ìŠ¤ì½”ë“œ ì†Œí†µì™•","ì‰ë°¸ê·¸íˆ¬","ì§ì ‘ ì…ë ¥"];let Ft=u(!1),Kt=u(null),Vt=u(!1),bt=u(null);async function nr(a){l(Kt,a,!0),l(Ft,!0),l(Vt,!0),l(bt,null);try{l(bt,await C.get(`/api/v1/facilitator/courses/${t(k)}/students/${a.legacy_user_id}/rubrics`),!0)}catch{y("ë£¨ë¸Œë¦­ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error")}finally{l(Vt,!1)}}ta(async()=>{if(!rt()){$e(`${Ie}/login`);return}C.post(`/api/v1/admin/sync/students/${t(k)}`).catch(()=>{}),await Promise.all([gt(),dr(),Wt()])});async function gt(){l(A,!0);try{l(D,await C.get(`/api/v1/facilitator/courses/${t(k)}/quests`),!0),l(I,new Set,!0)}catch{y("í€˜ìŠ¤íŠ¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error")}finally{l(A,!1)}}async function dr(){try{l(Qt,await C.get(`/api/v1/facilitator/courses/${t(k)}/students`),!0)}catch{}}async function Wt(){l(Pt,!0);try{l(Ht,await C.get(`/api/v1/facilitator/courses/${t(k)}/bonus-scores`),!0)}catch{y("ë¹„ì •ê·œ ì ìˆ˜ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error")}finally{l(Pt,!1)}}async function ur(){let a=t(at);if(t(at)==="ì§ì ‘ ì…ë ¥"&&(a=t(Rt).trim()),!t(xt)||t(ft)<=0||!a){y("í•™ìƒ, ì ìˆ˜, ì¹´í…Œê³ ë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.","error");return}l(Et,!0);try{await C.post(`/api/v1/facilitator/courses/${t(k)}/bonus-scores`,{legacy_student_id:t(xt),score:t(ft),category:a,reason:t(Tt).trim()}),y("ë¹„ì •ê·œ ì ìˆ˜ê°€ ë¶€ì—¬ë˜ì—ˆìŠµë‹ˆë‹¤.","success"),l(xt,null),l(ft,0),l(Tt,""),l(at,"í¼ì‹¤ì¬ëŸ‰ì ìˆ˜"),l(Rt,""),await Wt()}catch{y("ë¹„ì •ê·œ ì ìˆ˜ ë¶€ì—¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{l(Et,!1)}}async function vr(a){if(confirm("ì´ ë¹„ì •ê·œ ì ìˆ˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{await C.del(`/api/v1/facilitator/bonus-scores/${a}`),y("ë¹„ì •ê·œ ì ìˆ˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.","success"),await Wt()}catch{y("ë¹„ì •ê·œ ì ìˆ˜ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}}function cr(a){const o=a.match(/\/spreadsheets\/d\/([a-zA-Z0-9_-]+)/);return o?o[1]:a.trim()}function pr(){l(_t,""),l(qt,"í€˜ìŠ¤íŠ¸"),l(M,null),l(Nt,!0)}async function _r(){const a=cr(t(_t));if(!a){y("ìŠ¤í”„ë ˆë“œì‹œíŠ¸ URL ë˜ëŠ” IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.","error");return}l(zt,!0),l(M,null);try{const o=await C.post(`/api/v1/facilitator/courses/${t(k)}/import-sheet`,{spreadsheet_id:a,sheet_name:t(qt).trim()||"í€˜ìŠ¤íŠ¸"});l(M,o,!0),y(`ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ: í€˜ìŠ¤íŠ¸ ${o.quests_created}ê°œ ìƒì„±, ${o.quests_updated}ê°œ ê°±ì‹  / ì ìˆ˜ ${o.scores_created}ê°œ ìƒì„±, ${o.scores_updated}ê°œ ê°±ì‹ `,o.errors.length>0?"error":"success"),await gt()}catch{y("ì‹œíŠ¸ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{l(zt,!1)}}function xr(){l(X,null),l(ut,t(D).length>0?Math.max(...t(D).map(a=>a.quest_number))+1:1,!0),l(vt,"main"),l(ct,""),l(pt,new Date().toISOString().split("T")[0],!0),l(K,!0)}function fr(a){l(X,a,!0),l(ut,a.quest_number,!0),l(vt,a.quest_type,!0),l(ct,a.title||"",!0),l(pt,a.quest_date,!0),l(K,!0)}async function br(){l(Mt,!0);try{const a={quest_number:t(ut),quest_type:t(vt),title:t(ct).trim()||null,quest_date:t(pt)};t(X)?(await C.put(`/api/v1/facilitator/quests/${t(X).id}`,a),y("í€˜ìŠ¤íŠ¸ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.","success")):(await C.post(`/api/v1/facilitator/courses/${t(k)}/quests`,a),y("í€˜ìŠ¤íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.","success")),l(K,!1),await gt()}catch{y(t(X)?"í€˜ìŠ¤íŠ¸ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.":"í€˜ìŠ¤íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{l(Mt,!1)}}async function gr(a){if(confirm(`"${a.title||`#${a.quest_number}`}" í€˜ìŠ¤íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`))try{await C.del(`/api/v1/facilitator/quests/${a.id}`),y("í€˜ìŠ¤íŠ¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.","success"),await gt()}catch{y("í€˜ìŠ¤íŠ¸ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}}var Me=Pa(),Yt=dt(Me),Zt=r(Yt),mr=r(Zt);mr.__click=()=>$e(`${Ie}/facilitator`),ke(2),e(Zt);var je=s(Zt,2),Jt=r(je),Xt=r(Jt),qe=s(r(Xt),2),ze=r(qe);ze.__click=pr;var yr=s(ze,2);yr.__click=xr,e(qe),e(Xt);var hr=s(Xt,2);{var wr=a=>{Se(a,{type:"card",lines:4})},kr=a=>{var o=he(),p=dt(o);{var h=_=>{var f=ya();d(_,f)},b=_=>{var f=ja(),j=dt(f),z=r(j),Q=r(z);H(Q),Q.__change=lr;var B=s(Q,2),g=r(B);e(B),e(z);var T=s(z,2);{var R=x=>{var i=ha();i.__click=or;var S=r(i,!0);e(i),m(()=>{i.disabled=t(jt),n(S,t(jt)?"ì‚­ì œ ì¤‘...":`ì„ íƒ ì‚­ì œ (${t(I).size})`)}),d(x,i)};$(T,x=>{t(I).size>0&&x(R)})}e(j);var N=s(j,2);W(N,21,()=>[...t(D)].sort((x,i)=>x.quest_number-i.quest_number),Y,(x,i)=>{var S=Ma(),E=r(S),L=r(E);H(L),L.__change=()=>sr(t(i).id);var O=s(L,2);O.__click=()=>$e(`${Ie}/facilitator/quests/${t(i).id}`);var U=r(O),w=r(U),tt=r(w);e(w);var At=s(w,2),st=r(At),de=r(st,!0);e(st);var Bt=s(st,2),mt=r(Bt),yt=r(mt,!0);e(mt);var et=s(mt,2),ht=r(et,!0);e(et);var lt=s(et,4),Ot=r(lt);e(lt);var Ut=s(lt,2);{var ue=P=>{var F=wa(),kt=r(F);e(F),m(()=>{Lt(kt,1,`h-full rounded-full transition-all ${t(i).graded_count===t(i).total_students?"bg-green-500":"bg-blue-500"}`),_a(kt,`width: ${t(i).graded_count/t(i).total_students*100}%`)}),d(P,F)};$(Ut,P=>{t(i).total_students>0&&P(ue)})}var wt=s(Ut,2);{var ve=P=>{var F=Da(),kt=r(F),ce=r(kt),pe=r(ce),Cr=r(pe);e(pe);var Ar=s(pe,2);Ar.__click=()=>l(Ft,!1),e(ce);var Pe=s(ce,2),Br=r(Pe);{var Or=ot=>{Se(ot,{type:"card",lines:3})},Ur=ot=>{var Fe=he(),Gr=dt(Fe);{var Nr=it=>{var Gt=Ia(),Ke=s(dt(Gt),2);W(Ke,21,()=>t(bt).tasks,Y,(Pr,nt)=>{var _e=$a(),xe=r(_e),fe=r(xe),Fr=r(fe,!0);e(fe);var Ve=s(fe,2),be=r(Ve),Kr=r(be);e(be);var We=s(be,2),Vr=r(We);e(We),e(Ve),e(xe);var Ye=s(xe,2);{var Wr=St=>{var V=ka(),$t=r(V,!0);e(V),m(()=>n($t,t(nt).overall_feedback)),d(St,V)};$(Ye,St=>{t(nt).overall_feedback&&St(Wr)})}var Ze=s(Ye,2),Je=s(r(Ze));W(Je,21,()=>t(nt).rubric_items,Y,(St,V)=>{var $t=Sa(),ge=r($t),Yr=r(ge,!0);e(ge);var me=s(ge),Zr=r(me,!0);e(me);var ye=s(me),Jr=r(ye,!0);e(ye);var Xe=s(ye),Xr=r(Xe,!0);e(Xe),e($t),m(()=>{n(Yr,t(V).rubric_metric),n(Zr,t(V).human_score??"-"),n(Jr,t(V).gpt_score??"-"),n(Xr,t(V).feedback||"-")}),d(St,$t)}),e(Je),e(Ze),e(_e),m(()=>{n(Fr,t(nt).task_title),n(Kr,`H: ${t(nt).total_human??""}`),n(Vr,`G: ${t(nt).total_gpt??""}`)}),d(Pr,_e)}),e(Ke),d(it,Gt)},Hr=it=>{var Gt=La();d(it,Gt)};$(Gr,it=>{t(bt)&&t(bt).tasks.length>0?it(Nr):it(Hr,!1)},!0)}d(ot,Fe)};$(Br,ot=>{t(Vt)?ot(Or):ot(Ur,!1)})}e(Pe),e(kt),e(F),m(()=>n(Cr,`${t(Kt).name??""} í•™ìƒ ìƒì„¸ ì •ë³´`)),d(P,F)};$(wt,P=>{t(Ft)&&t(Kt)&&P(ve)})}e(Bt),e(At),e(U),e(O),e(E);var Ne=s(E,2),He=r(Ne);He.__click=()=>fr(t(i));var Er=s(He,2);Er.__click=()=>gr(t(i)),e(Ne),e(S),m((P,F)=>{Lt(S,1,`bg-white rounded-lg border p-4 flex items-center justify-between hover:shadow-sm transition-shadow ${P??""}`),er(L,F),n(tt,`#${t(i).quest_number??""}`),n(de,t(i).title||rr[t(i).quest_type]),n(yt,rr[t(i).quest_type]),n(ht,t(i).quest_date),Lt(lt,1,pa(t(i).graded_count===t(i).total_students&&t(i).total_students>0?"text-green-600 font-medium":"text-gray-500")),n(Ot,`ì±„ì  ${t(i).graded_count??""}/${t(i).total_students??""}`)},[()=>t(I).has(t(i).id)?"border-blue-400 bg-blue-50/30":"border-gray-200",()=>t(I).has(t(i).id)]),d(x,S)}),e(N),m(()=>{er(Q,t(De)),n(g,`ì „ì²´ ì„ íƒ (${t(I).size??""}/${t(D).length??""})`)}),d(_,f)};$(p,_=>{t(D).length===0?_(h):_(b,!1)},!0)}d(a,o)};$(hr,a=>{t(A)?a(wr):a(kr,!1)})}e(Jt);var te=s(Jt,2),ee=s(r(te),2),Qe=s(r(ee),2),re=r(Qe),ae=s(r(re),2),se=r(ae);se.value=(se.__value=null)??"";var Sr=s(se);W(Sr,17,()=>t(Qt),Y,(a,o)=>{var p=qa(),h=r(p,!0);e(p);var b={};m(()=>{n(h,t(o).name),b!==(b=t(o).legacy_user_id)&&(p.value=(p.__value=t(o).legacy_user_id)??"")}),d(a,p)}),e(ae),e(re);var le=s(re,2),oe=r(le),Re=s(r(oe),2);H(Re),e(oe);var Te=s(oe,2),ie=r(Te),ne=s(r(ie),2);W(ne,21,()=>ir,Y,(a,o)=>{var p=za(),h=r(p,!0);e(p);var b={};m(()=>{n(h,t(o)),b!==(b=t(o))&&(p.value=(p.__value=t(o))??"")}),d(a,p)}),e(ne),e(ie);var Ee=s(ie,2);{var $r=a=>{var o=Qa();H(o),Z(o,()=>t(Rt),p=>l(Rt,p)),d(a,o)};$(Ee,a=>{t(at)==="ì§ì ‘ ì…ë ¥"&&a($r)})}var Ce=s(Ee,2),Ae=r(Ce);H(Ae),e(Ce),e(Te),e(le);var Ct=s(le,2);Ct.__click=ur;var Ir=r(Ct,!0);e(Ct),e(Qe),e(ee);var Lr=s(ee,2);{var Dr=a=>{Se(a,{type:"card",lines:3})},Mr=a=>{var o=he(),p=dt(o);{var h=_=>{var f=Ra();d(_,f)},b=_=>{var f=Ea(),j=r(f),z=r(j),Q=s(r(z));W(Q,21,()=>t(Ht),Y,(B,g)=>{var T=Ta(),R=r(T),N=r(R,!0);e(R);var x=s(R),i=r(x);e(x);var S=s(x),E=r(S,!0);e(S);var L=s(S),O=r(L,!0);e(L);var U=s(L),w=r(U);w.__click=()=>vr(t(g).id),e(U),e(T),m(tt=>{ca(T,"title",`${t(g).given_by_name??""} Â· ${tt??""}`),n(N,t(g).student_name),n(i,`+${t(g).score??""}`),n(E,t(g).category),n(O,t(g).reason)},[()=>new Date(t(g).given_at).toLocaleDateString("ko-KR")]),d(B,T)}),e(Q),e(z),e(j),e(f),d(_,f)};$(p,_=>{t(Ht).length===0?_(h):_(b,!1)},!0)}d(a,o)};$(Lr,a=>{t(Pt)?a(Dr):a(Mr,!1)})}e(te);var Be=s(te,2),Oe=s(r(Be),2),Ue=r(Oe),jr=r(Ue);{var qr=a=>{var o=Ca();d(a,o)},zr=a=>{var o=Ba();W(o,21,()=>t(Qt),Y,(p,h)=>{var b=Aa(),_=r(b);_.__click=()=>nr(t(h));var f=r(_),j=r(f,!0);e(f),ke(2),e(_),e(b),m(()=>n(j,t(h).name)),d(p,b)}),e(o),d(a,o)};$(jr,a=>{t(Qt).length===0?a(qr):a(zr,!1)})}e(Ue),e(Oe),e(Be),e(je),e(Yt);var Ge=s(Yt,2);{var Qr=a=>{var o=Oa(),p=r(o),h=r(p),b=r(h,!0);e(h);var _=s(h,2),f=r(_),j=s(r(f),2);H(j),e(f);var z=s(f,2),Q=s(r(z),2),B=r(Q);B.value=B.__value="sub";var g=s(B);g.value=g.__value="main";var T=s(g);T.value=T.__value="datathon";var R=s(T);R.value=R.__value="ideathon",e(Q),e(z);var N=s(z,2),x=s(r(N),2);H(x),e(N);var i=s(N,2),S=s(r(i),2);H(S),e(i);var E=s(i,2),L=r(E);L.__click=()=>l(K,!1);var O=s(L,2),U=r(O,!0);e(O),e(E),e(_),e(p),e(o),m(()=>{n(b,t(X)?"í€˜ìŠ¤íŠ¸ ìˆ˜ì •":"í€˜ìŠ¤íŠ¸ ì¶”ê°€"),O.disabled=t(Mt),n(U,t(Mt)?"ì €ì¥ ì¤‘...":t(X)?"ìˆ˜ì •":"ì¶”ê°€")}),va("submit",_,w=>{w.preventDefault(),br()}),Z(j,()=>t(ut),w=>l(ut,w)),Le(Q,()=>t(vt),w=>l(vt,w)),Z(x,()=>t(ct),w=>l(ct,w)),Z(S,()=>t(pt),w=>l(pt,w)),d(a,o)};$(Ge,a=>{t(K)&&a(Qr)})}var Rr=s(Ge,2);{var Tr=a=>{var o=Ha(),p=r(o),h=s(r(p),4),b=r(h),_=s(r(b),2);H(_),e(b);var f=s(b,2),j=s(r(f),2);H(j),ke(2),e(f);var z=s(f,2);{var Q=x=>{var i=Na(),S=r(i),E=s(S,2),L=s(r(E),2),O=r(L);e(L);var U=s(L,4),w=r(U);e(U);var tt=s(U,4),At=r(tt);e(tt);var st=s(tt,4),de=r(st);e(st),e(E);var Bt=s(E,2);{var mt=yt=>{var et=Ga(),ht=r(et),lt=r(ht);e(ht);var Ot=s(ht,2);W(Ot,21,()=>t(M).errors,Y,(Ut,ue)=>{var wt=Ua(),ve=r(wt);e(wt),m(()=>n(ve,`Â· ${t(ue)??""}`)),d(Ut,wt)}),e(Ot),e(et),m(()=>n(lt,`ì˜¤ë¥˜ (${t(M).errors.length??""}ê±´):`)),d(yt,et)};$(Bt,yt=>{t(M).errors.length>0&&yt(mt)})}e(i),m(()=>{Lt(i,1,`rounded-lg border p-3 ${t(M).errors.length>0?"border-yellow-300 bg-yellow-50":"border-green-300 bg-green-50"}`),Lt(S,1,`text-sm font-medium ${t(M).errors.length>0?"text-yellow-800":"text-green-800"} mb-2`),n(O,`${t(M).quests_created??""}ê°œ`),n(w,`${t(M).quests_updated??""}ê°œ`),n(At,`${t(M).scores_created??""}ê°œ`),n(de,`${t(M).scores_updated??""}ê°œ`)}),d(x,i)};$(z,x=>{t(M)&&x(Q)})}var B=s(z,2),g=r(B);g.__click=()=>l(Nt,!1);var T=r(g,!0);e(g);var R=s(g,2);R.__click=_r;var N=r(R,!0);e(R),e(B),e(h),e(p),e(o),m(x=>{n(T,t(M)?"ë‹«ê¸°":"ì·¨ì†Œ"),R.disabled=x,n(N,t(zt)?"ê°€ì ¸ì˜¤ëŠ” ì¤‘...":"ê°€ì ¸ì˜¤ê¸°")},[()=>t(zt)||!t(_t).trim()]),Z(_,()=>t(_t),x=>l(_t,x)),Z(j,()=>t(qt),x=>l(qt,x)),d(a,o)};$(Rr,a=>{t(Nt)&&a(Tr)})}m(()=>{Ct.disabled=t(Et),n(Ir,t(Et)?"ë¶€ì—¬ ì¤‘...":"+ ë¶€ì—¬")}),Le(ae,()=>t(xt),a=>l(xt,a)),Z(Re,()=>t(ft),a=>l(ft,a)),Le(ne,()=>t(at),a=>l(at,a)),Z(Ae,()=>t(Tt),a=>l(Tt,a)),d(c,Me),da(),J()}ua(["click","change"]);export{ds as component};
