import{a as v,f as _,c as Le}from"../chunks/_V9dK3ok.js";import{o as _r}from"../chunks/1hPTKaIJ.js";import{l as mr,an as yr,ai as hr,a0 as wr,ao as Sr,ap as $r,n as et,o as kr,p as Lr,b as d,d as V,f as pe,t as D,g as e,a as Mr,e as o,c as s,s as l,h as qt,q as tt,r}from"../chunks/CcVkWGgp.js";import{d as Tr,s as x,e as qr}from"../chunks/Dap9sqf4.js";import{i as N}from"../chunks/BSGnc2-w.js";import{e as H,i as J}from"../chunks/GjfVCmik.js";import{a as $,r as G,s as rt,c as Cr}from"../chunks/By8uYFO7.js";import{s as at}from"../chunks/CWDCDM9S.js";import{b as W}from"../chunks/CZzPbpj5.js";import{s as Dr,a as Nr}from"../chunks/Dn1l8nLM.js";import{p as Rr}from"../chunks/CiWVzWZ4.js";import{g as Ct}from"../chunks/CJRVfnLM.js";import{b as Dt}from"../chunks/Ch8GEA1F.js";import{a as R}from"../chunks/D50DVwTZ.js";import{i as Er}from"../chunks/3jTL0Oy-.js";import{Q as Ir}from"../chunks/DqiXTygU.js";import{L as Qr}from"../chunks/C0NRKcx4.js";function Nt(c,T,X=!1){if(c.multiple){if(T==null)return;if(!wr(T))return Sr();for(var O of c.options)O.selected=T.includes(be(O));return}for(O of c.options){var Y=be(O);if($r(Y,T)){O.selected=!0;return}}(!X||T!==void 0)&&(c.selectedIndex=-1)}function zr(c){var T=new MutationObserver(()=>{Nt(c,c.__value)});T.observe(c,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),hr(()=>{T.disconnect()})}function st(c,T,X=T){var O=new WeakSet,Y=!0;mr(c,"change",Q=>{var j=Q?"[selected]":":checked",h;if(c.multiple)h=[].map.call(c.querySelectorAll(j),be);else{var ee=c.querySelector(j)??c.querySelector("option:not([disabled])");h=ee&&be(ee)}X(h),et!==null&&O.add(et)}),yr(()=>{var Q=T();if(c===document.activeElement){var j=kr??et;if(O.has(j))return}if(Nt(c,Q,Y),Y&&Q===void 0){var h=c.querySelector(":checked");h!==null&&(Q=be(h),X(Q))}c.__value=Q,Y=!1}),zr(c)}function be(c){return"__value"in c?c.__value:c.value}var Br=_('<th class="px-1 py-1 text-center min-w-[120px] border-r border-b border-gray-300"><div class="flex flex-col items-center gap-1"><button class="text-xs font-semibold text-gray-700 hover:text-blue-700 cursor-pointer"> </button></div></th>'),Or=_('<tr><td class="px-3 py-6 text-center text-gray-500">ì ìˆ˜í‘œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</td></tr>'),Ur=_('<tr><td class="px-3 py-6 text-center text-gray-500">ì—´ ë + ë²„íŠ¼ìœ¼ë¡œ í€˜ìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.</td></tr>'),jr=_('<span class="text-[10px] text-blue-500">ì €ì¥</span>'),Ar=_('<span class="text-[10px] text-red-500">ì‹¤íŒ¨</span>'),Pr=_('<td class="p-0 border-r border-gray-200"><div class="flex items-center justify-center gap-0.5"><input type="text" inputmode="decimal" placeholder="-"/> <!></div></td>'),Gr=_('<tr class="border-b border-gray-300 hover:bg-gray-50/70"><td class="sticky left-0 z-10 bg-white px-2 py-1 font-medium text-gray-800 border-r border-gray-300"><button class="text-left hover:text-blue-700 cursor-pointer truncate max-w-[150px] leading-tight"> </button></td><!><td class="p-0"></td></tr>'),Kr=_("<option> </option>"),Fr=_("<option> </option>"),Vr=_('<input type="text" placeholder="ì¹´í…Œê³ ë¦¬ ì…ë ¥" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/>'),Wr=_('<div class="text-center py-8 text-gray-400 text-sm bg-white rounded-lg border border-gray-200">ë¶€ì—¬ëœ ë¹„ì •ê·œ ì ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</div>'),Yr=_('<tr class="hover:bg-gray-50"><td class="px-3 py-2 font-medium text-gray-800 max-w-full lg:max-w-[80px] truncate"> </td><td class="px-3 py-2 text-center font-bold text-green-600"> </td><td class="px-3 py-2 text-xs text-gray-800 max-w-full lg:max-w-[80px] truncate"> </td><td class="px-3 py-2 text-gray-600 max-w-full lg:max-w-[100px] truncate"> </td><td class="px-3 py-2 text-center"><button class="text-red-400 hover:text-red-600 cursor-pointer text-xs">ì‚­ì œ</button></td></tr>'),Zr=_('<div class="bg-white rounded-lg border border-gray-200 overflow-hidden"><div class="max-h-[360px] overflow-y-auto"><table class="w-full text-sm"><thead class="bg-gray-50 sticky top-0"><tr><th class="px-3 py-2 text-left text-xs font-medium text-gray-500">í•™ìƒ</th><th class="px-3 py-2 text-center text-xs font-medium text-gray-500">ì ìˆ˜</th><th class="px-3 py-2 text-left text-xs font-medium text-gray-500">ì¹´í…Œê³ ë¦¬</th><th class="px-3 py-2 text-left text-xs font-medium text-gray-500">ì‚¬ìœ </th><th class="px-3 py-2 text-center text-xs font-medium text-gray-500 w-10"></th></tr></thead><tbody class="divide-y divide-gray-100"></tbody></table></div></div>'),Hr=_('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40"><div class="bg-white rounded-xl shadow-xl w-full max-w-md mx-4 p-6"><h2 class="text-lg font-bold text-gray-800 mb-4"> </h2> <form class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">í€˜ìŠ¤íŠ¸ ë²ˆí˜¸</label> <input type="number" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ìœ í˜•</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"><option>ì„œë¸Œí€˜ìŠ¤íŠ¸ (0~1)</option><option>ë©”ì¸í€˜ìŠ¤íŠ¸ (0~5)</option><option>ë°ì´í„°í†¤ (0~10)</option><option>ì•„ì´ë””ì–´í†¤ (0~20)</option></select></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ì œëª© (ì„ íƒ)</label> <input type="text" placeholder="ì˜ˆ: ë¨¸ì‹ ëŸ¬ë‹ ê¸°ì´ˆ" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ë‚ ì§œ</label> <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div class="flex gap-2 pt-2"><button type="button" class="flex-1 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 cursor-pointer">ì·¨ì†Œ</button> <button type="submit" class="flex-1 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 disabled:opacity-50 cursor-pointer"> </button></div></form></div></div>'),Jr=_("<li> </li>"),Xr=_('<div class="mt-2 pt-2 border-t border-yellow-200"><p class="text-xs font-medium text-yellow-700 mb-1"> </p> <ul class="text-xs text-yellow-600 space-y-0.5 max-h-24 overflow-y-auto"></ul></div>'),ea=_('<div><p>ê°€ì ¸ì˜¤ê¸° ê²°ê³¼</p> <div class="grid grid-cols-2 gap-1 text-xs"><span class="text-gray-600">í€˜ìŠ¤íŠ¸ ìƒì„±:</span> <span class="font-medium"> </span> <span class="text-gray-600">í€˜ìŠ¤íŠ¸ ê°±ì‹ :</span> <span class="font-medium"> </span> <span class="text-gray-600">ì ìˆ˜ ìƒì„±:</span> <span class="font-medium"> </span> <span class="text-gray-600">ì ìˆ˜ ê°±ì‹ :</span> <span class="font-medium"> </span></div> <!></div>'),ta=_('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40"><div class="bg-white rounded-xl shadow-xl w-full max-w-lg mx-4 p-6"><h2 class="text-lg font-bold text-gray-800 mb-1">ğŸ“¥ ì‹œíŠ¸ì—ì„œ í€˜ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°</h2> <p class="text-xs text-gray-500 mb-4">Google ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì˜ "í€˜ìŠ¤íŠ¸" ì‹œíŠ¸ì—ì„œ í€˜ìŠ¤íŠ¸ ëª©ë¡ê³¼ ì ìˆ˜ë¥¼ ìë™ìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.</p> <div class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">ìŠ¤í”„ë ˆë“œì‹œíŠ¸ URL ë˜ëŠ” ID</label> <input type="text" placeholder="https://docs.google.com/spreadsheets/d/... ë˜ëŠ” ID" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ì‹œíŠ¸ ì´ë¦„</label> <input type="text" placeholder="í€˜ìŠ¤íŠ¸" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500"/> <p class="text-xs text-gray-400 mt-1">ê¸°ë³¸ê°’: "í€˜ìŠ¤íŠ¸"</p></div> <!> <div class="flex gap-2 pt-2"><button type="button" class="flex-1 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 cursor-pointer"> </button> <button type="button" class="flex-1 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 disabled:opacity-50 cursor-pointer"> </button></div></div></div></div>'),ra=_('<div class="max-w-[1600px] mx-auto px-3 py-6 sm:px-6"><div class="mb-6"><button class="text-sm text-blue-600 hover:text-blue-800 mb-2 cursor-pointer">â† ê³¼ì • ëª©ë¡</button> <h1 class="text-2xl font-bold text-gray-800">í€˜ìŠ¤íŠ¸ ê´€ë¦¬</h1></div> <div class="space-y-6"><div class="flex-1 min-w-0"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-4"><h2 class="text-lg font-semibold text-gray-700">í•™ìƒ x í€˜ìŠ¤íŠ¸ ì ìˆ˜í‘œ</h2> <div class="flex flex-col sm:flex-row gap-2"><button class="px-3 py-2 text-sm border border-green-600 text-green-700 rounded-lg hover:bg-green-50 transition-colors cursor-pointer">ğŸ“¥ ì‹œíŠ¸ì—ì„œ ê°€ì ¸ì˜¤ê¸°</button> <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer">+ í€˜ìŠ¤íŠ¸ ì¶”ê°€</button></div></div> <div class="border border-gray-300 bg-white overflow-hidden mb-3"><div class="overflow-auto"><table class="w-full min-w-[980px] text-sm border-collapse"><thead class="bg-gray-100"><tr><th class="sticky left-0 z-10 bg-gray-100 px-2 py-1 text-left font-semibold text-gray-700 min-w-[160px] border-r border-b border-gray-300">í•™ìƒ</th><!><th class="px-1 py-1 text-center min-w-[60px] border-b border-gray-300"><button class="w-8 h-8 rounded-md border border-dashed border-gray-300 text-gray-500 hover:text-blue-600 hover:border-blue-400 cursor-pointer">+</button></th></tr></thead><tbody><!></tbody></table></div></div> <!></div> <div class="w-full"><h2 class="text-lg font-semibold text-gray-700 mb-4">ë¹„ì •ê·œ ì ìˆ˜ ê´€ë¦¬</h2> <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 items-start"><div class="bg-white rounded-lg border border-gray-200 p-4"><h3 class="text-sm font-medium text-gray-700 mb-3">ë¹„ì •ê·œ ì ìˆ˜ ë¶€ì—¬</h3> <div class="space-y-3"><div><label class="block text-xs text-gray-500 mb-1">í•™ìƒ</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"><option>í•™ìƒ ì„ íƒ</option><!></select></div> <div class="flex flex-col sm:flex-row gap-3"><div class="w-20"><label class="block text-xs text-gray-500 mb-1">ì ìˆ˜</label> <input type="number" step="0.5" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div class="flex-1 space-y-2"><div><label class="block text-xs text-gray-500 mb-1">ì¹´í…Œê³ ë¦¬</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></select></div> <!> <div><input type="text" placeholder="ìƒì„¸ ì‚¬ìœ  (ì„ íƒ)" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div></div></div> <button class="w-full px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors cursor-pointer"> </button></div></div> <!></div></div> <!></div></div> <!> <!>',1);function ya(c,T){Lr(T,!0);const X=()=>Nr(Er,"$isLoggedIn",O),[O,Y]=Dr();let Q=d(!0),j=d(V([])),h=qt(()=>Rr.params.courseId),ee=d(!1),ae=d(V({}));const ot=new Map;let te=qt(()=>[...e(j)].sort((t,a)=>t.quest_number-a.quest_number));function fe(t,a){return`${t}:${a}`}function K(t,a){return e(ae)[fe(t,a)]||{score:"",isSubmitted:!1,saving:!1,error:!1}}function ge(t,a,n){const i=fe(t,a);o(ae,{...e(ae),[i]:{...K(t,a),...n}},!0)}function Rt(t,a,n){if(!n||t.trim()==="")return"bg-white text-gray-500";const i=Number(t);return Number.isNaN(i)?"bg-white text-gray-500":a==="sub"?i<=0?"bg-red-50 text-red-700":i<.5?"bg-amber-50 text-amber-700":i<1?"bg-lime-50 text-lime-700":"bg-emerald-100 text-emerald-800":a==="main"?i<=0?"bg-red-50 text-red-700":i<2?"bg-orange-50 text-orange-700":i<3?"bg-amber-50 text-amber-700":i<4?"bg-lime-50 text-lime-700":i<5?"bg-emerald-50 text-emerald-700":"bg-indigo-100 text-indigo-800":a==="datathon"?i<=0?"bg-red-50 text-red-700":i<4?"bg-amber-50 text-amber-700":i<7?"bg-lime-50 text-lime-700":"bg-emerald-100 text-emerald-800":i<=0?"bg-red-50 text-red-700":i<8?"bg-amber-50 text-amber-700":i<14?"bg-lime-50 text-lime-700":"bg-emerald-100 text-emerald-800"}let se=d(!1),xe=d(!1),oe=d(1),le=d("main"),ie=d(""),ne=d(V(new Date().toISOString().split("T")[0])),Z=d(null),Et=d(V(new Set)),Me=d(!1),de=d(""),_e=d("í€˜ìŠ¤íŠ¸"),me=d(!1),L=d(null),lt=d(V([])),ye=d(V([])),It=d(V([])),Te=d(V([])),qe=d(!1),ue=d(null),ce=d(0),re=d("í¼ì‹¤ì¬ëŸ‰ì ìˆ˜"),he=d(""),we=d(""),Se=d(!1);const Qt=["í¼ì‹¤ì¬ëŸ‰ì ìˆ˜","ì•„ë‚Œì—†ì´ ì£¼ëŠ” ê·¸ë£¨","ë””ìŠ¤ì½”ë“œ ì†Œí†µì™•","ì‰ë°¸ê·¸íˆ¬","ì§ì ‘ ì…ë ¥"];let zt=d(!1),Bt=d(null),it=d(!1),nt=d(null);async function Ot(t){o(Bt,t,!0),o(zt,!0),o(it,!0),o(nt,null);try{o(nt,await R.get(`/api/v1/facilitator/courses/${e(h)}/students/${t.legacy_user_id}/rubrics`),!0)}catch{$("ë£¨ë¸Œë¦­ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error")}finally{o(it,!1)}}_r(async()=>{if(!X()){Ct(`${Dt}/login`);return}R.post(`/api/v1/admin/sync/students/${e(h)}`).catch(()=>{}),await Ce(),await Ut(),await De(),await Ne()});async function Ce(){o(Q,!0);try{o(j,await R.get(`/api/v1/facilitator/courses/${e(h)}/quests`),!0),o(Et,new Set,!0)}catch{$("í€˜ìŠ¤íŠ¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error")}finally{o(Q,!1)}}async function Ut(){try{const[t,a]=await Promise.all([R.get(`/api/v1/facilitator/courses/${e(h)}/students?active=true`),R.get(`/api/v1/facilitator/courses/${e(h)}/students?active=false`)]);o(ye,t,!0),o(It,a,!0),o(lt,t,!0)}catch{}}async function De(){if(e(te).length===0||e(ye).length===0){o(ae,{},!0);return}o(ee,!0);try{const t={};await Promise.all(e(te).map(async a=>{const n=await R.get(`/api/v1/facilitator/quests/${a.id}/students`);for(const i of n)e(ye).find(u=>u.legacy_user_id===i.legacy_student_id)&&(t[fe(i.legacy_student_id,a.id)]={score:i.score===null?"":String(i.score),isSubmitted:i.is_submitted,saving:!1,error:!1})})),o(ae,t,!0)}catch{$("ì ìˆ˜ ë§¤íŠ¸ë¦­ìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.","error")}finally{o(ee,!1)}}function jt(t,a,n){const i=n.trim();i!==""&&!/^\d+(\.\d+)?$/.test(i)||(ge(t,a.id,{score:i,isSubmitted:i!=="",error:!1}),At(t,a.id,a.quest_type))}function At(t,a,n){const i=fe(t,a),u=ot.get(i);u&&clearTimeout(u),ot.set(i,setTimeout(()=>{Pt(t,a)},450))}async function Pt(t,a,n){const i=K(t,a);ge(t,a,{saving:!0,error:!1});try{const u=i.score===""?null:Number(i.score);await R.post(`/api/v1/facilitator/quests/${a}/scores`,{scores:[{legacy_student_id:t,score:u,is_submitted:u!==null}]}),ge(t,a,{saving:!1,error:!1,isSubmitted:u!==null})}catch{ge(t,a,{saving:!1,error:!0}),$("ì ìˆ˜ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}}async function Ne(){o(qe,!0);try{o(Te,await R.get(`/api/v1/facilitator/courses/${e(h)}/bonus-scores`),!0)}catch{$("ë¹„ì •ê·œ ì ìˆ˜ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error")}finally{o(qe,!1)}}async function Gt(){let t=e(re);if(e(re)==="ì§ì ‘ ì…ë ¥"&&(t=e(he).trim()),!e(ue)||e(ce)<=0||!t){$("í•™ìƒ, ì ìˆ˜, ì¹´í…Œê³ ë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.","error");return}o(Se,!0);try{await R.post(`/api/v1/facilitator/courses/${e(h)}/bonus-scores`,{legacy_student_id:e(ue),score:e(ce),category:t,reason:e(we).trim()}),$("ë¹„ì •ê·œ ì ìˆ˜ê°€ ë¶€ì—¬ë˜ì—ˆìŠµë‹ˆë‹¤.","success"),o(ue,null),o(ce,0),o(we,""),o(re,"í¼ì‹¤ì¬ëŸ‰ì ìˆ˜"),o(he,""),await Ne()}catch{$("ë¹„ì •ê·œ ì ìˆ˜ ë¶€ì—¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{o(Se,!1)}}async function Kt(t){if(confirm("ì´ ë¹„ì •ê·œ ì ìˆ˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{await R.del(`/api/v1/facilitator/bonus-scores/${t}`),$("ë¹„ì •ê·œ ì ìˆ˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.","success"),await Ne()}catch{$("ë¹„ì •ê·œ ì ìˆ˜ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}}function Ft(t){const a=t.match(/\/spreadsheets\/d\/([a-zA-Z0-9_-]+)/);return a?a[1]:t.trim()}function Vt(){o(de,""),o(_e,"í€˜ìŠ¤íŠ¸"),o(L,null),o(Me,!0)}async function Wt(){const t=Ft(e(de));if(!t){$("ìŠ¤í”„ë ˆë“œì‹œíŠ¸ URL ë˜ëŠ” IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.","error");return}o(me,!0),o(L,null);try{const a=await R.post(`/api/v1/facilitator/courses/${e(h)}/import-sheet`,{spreadsheet_id:t,sheet_name:e(_e).trim()||"í€˜ìŠ¤íŠ¸"});o(L,a,!0),$(`ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ: í€˜ìŠ¤íŠ¸ ${a.quests_created}ê°œ ìƒì„±, ${a.quests_updated}ê°œ ê°±ì‹  / ì ìˆ˜ ${a.scores_created}ê°œ ìƒì„±, ${a.scores_updated}ê°œ ê°±ì‹ `,a.errors.length>0?"error":"success"),await Ce(),await De()}catch{$("ì‹œíŠ¸ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{o(me,!1)}}function dt(){o(Z,null),o(oe,e(j).length>0?Math.max(...e(j).map(t=>t.quest_number))+1:1,!0),o(le,"main"),o(ie,""),o(ne,new Date().toISOString().split("T")[0],!0),o(se,!0)}function Yt(t){o(Z,t,!0),o(oe,t.quest_number,!0),o(le,t.quest_type,!0),o(ie,t.title||"",!0),o(ne,t.quest_date,!0),o(se,!0)}async function Zt(){o(xe,!0);try{const t={quest_number:e(oe),quest_type:e(le),title:e(ie).trim()||null,quest_date:e(ne)};e(Z)?(await R.put(`/api/v1/facilitator/quests/${e(Z).id}`,t),$("í€˜ìŠ¤íŠ¸ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.","success")):(await R.post(`/api/v1/facilitator/courses/${e(h)}/quests`,t),$("í€˜ìŠ¤íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.","success")),o(se,!1),await Ce(),await De()}catch{$(e(Z)?"í€˜ìŠ¤íŠ¸ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.":"í€˜ìŠ¤íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{o(xe,!1)}}var ut=ra(),Re=pe(ut),Ee=s(Re),Ht=s(Ee);Ht.__click=()=>Ct(`${Dt}/facilitator`),tt(2),r(Ee);var ct=l(Ee,2),Ie=s(ct),Qe=s(Ie),vt=l(s(Qe),2),pt=s(vt);pt.__click=Vt;var Jt=l(pt,2);Jt.__click=dt,r(vt),r(Qe);var ze=l(Qe,2),bt=s(ze),ft=s(bt),Be=s(ft),gt=s(Be),xt=l(s(gt));H(xt,17,()=>e(te),J,(t,a)=>{var n=Br(),i=s(n),u=s(i);u.__click=()=>Yt(e(a));var p=s(u,!0);r(u),r(i),r(n),D(()=>x(p,e(a).title||`${Ir[e(a).quest_type]} #${e(a).quest_number}`)),v(t,n)});var _t=l(xt),Xt=s(_t);Xt.__click=dt,r(_t),r(gt),r(Be);var mt=l(Be),er=s(mt);{var tr=t=>{var a=Or(),n=s(a);r(a),D(()=>rt(n,"colspan",e(te).length+2)),v(t,a)},rr=t=>{var a=Le(),n=pe(a);{var i=p=>{var b=Ur(),E=s(b);rt(E,"colspan",2),r(b),v(p,b)},u=p=>{var b=Le(),E=pe(b);H(E,17,()=>e(ye),J,(z,m)=>{var I=Gr(),f=s(I),M=s(f);M.__click=()=>Ot(e(m));var q=s(M,!0);r(M),r(f);var A=l(f);H(A,17,()=>e(te),J,(y,g)=>{var C=Pr(),B=s(C),w=s(B);G(w),w.__input=S=>jt(e(m).legacy_user_id,e(g),S.currentTarget.value);var P=l(w,2);{var U=S=>{var F=jr();v(S,F)},k=S=>{var F=Le(),ke=pe(F);{var We=ve=>{var Ye=Ar();v(ve,Ye)};N(ke,ve=>{K(e(m).legacy_user_id,e(g).id).error&&ve(We)},!0)}v(S,F)};N(P,S=>{K(e(m).legacy_user_id,e(g).id).saving?S(U):S(k,!1)})}r(B),r(C),D((S,F)=>{Cr(w,S),at(w,1,F)},[()=>K(e(m).legacy_user_id,e(g).id).score,()=>`w-full h-7 px-1 py-0 text-center border-0 rounded-none text-xs font-medium focus:outline-none focus:ring-0 ${Rt(K(e(m).legacy_user_id,e(g).id).score,e(g).quest_type,K(e(m).legacy_user_id,e(g).id).isSubmitted)} ${K(e(m).legacy_user_id,e(g).id).error?"bg-red-100 text-red-800":""}`]),v(y,C)}),tt(),r(I),D(()=>x(q,e(m).name)),v(z,I)}),v(p,b)};N(n,p=>{e(te).length===0?p(i):p(u,!1)},!0)}v(t,a)};N(er,t=>{e(Q)||e(ee)?t(tr):t(rr,!1)})}r(mt),r(ft),r(bt),r(ze);var ar=l(ze,2);N(ar,t=>{}),r(Ie);var Oe=l(Ie,2),yt=l(s(Oe),2),Ue=s(yt),ht=l(s(Ue),2),je=s(ht),Ae=l(s(je),2),Pe=s(Ae);Pe.value=(Pe.__value=null)??"";var sr=l(Pe);H(sr,17,()=>e(lt),J,(t,a)=>{var n=Kr(),i=s(n,!0);r(n);var u={};D(()=>{x(i,e(a).name),u!==(u=e(a).legacy_user_id)&&(n.value=(n.__value=e(a).legacy_user_id)??"")}),v(t,n)}),r(Ae),r(je);var Ge=l(je,2),Ke=s(Ge),wt=l(s(Ke),2);G(wt),r(Ke);var St=l(Ke,2),Fe=s(St),Ve=l(s(Fe),2);H(Ve,21,()=>Qt,J,(t,a)=>{var n=Fr(),i=s(n,!0);r(n);var u={};D(()=>{x(i,e(a)),u!==(u=e(a))&&(n.value=(n.__value=e(a))??"")}),v(t,n)}),r(Ve),r(Fe);var $t=l(Fe,2);{var or=t=>{var a=Vr();G(a),W(a,()=>e(he),n=>o(he,n)),v(t,a)};N($t,t=>{e(re)==="ì§ì ‘ ì…ë ¥"&&t(or)})}var kt=l($t,2),Lt=s(kt);G(Lt),r(kt),r(St),r(Ge);var $e=l(Ge,2);$e.__click=Gt;var lr=s($e,!0);r($e),r(ht),r(Ue);var ir=l(Ue,2);{var nr=t=>{Qr(t,{type:"card",lines:3})},dr=t=>{var a=Le(),n=pe(a);{var i=p=>{var b=Wr();v(p,b)},u=p=>{var b=Zr(),E=s(b),z=s(E),m=l(s(z));H(m,21,()=>e(Te),J,(I,f)=>{var M=Yr(),q=s(M),A=s(q,!0);r(q);var y=l(q),g=s(y);r(y);var C=l(y),B=s(C,!0);r(C);var w=l(C),P=s(w,!0);r(w);var U=l(w),k=s(U);k.__click=()=>Kt(e(f).id),r(U),r(M),D(S=>{rt(M,"title",`${e(f).given_by_name??""} Â· ${S??""}`),x(A,e(f).student_name),x(g,`+${e(f).score??""}`),x(B,e(f).category),x(P,e(f).reason)},[()=>new Date(e(f).given_at).toLocaleDateString("ko-KR")]),v(I,M)}),r(m),r(z),r(E),r(b),v(p,b)};N(n,p=>{e(Te).length===0?p(i):p(u,!1)},!0)}v(t,a)};N(ir,t=>{e(qe)?t(nr):t(dr,!1)})}r(yt),r(Oe);var ur=l(Oe,2);N(ur,t=>{}),r(ct),r(Re);var Mt=l(Re,2);{var cr=t=>{var a=Hr(),n=s(a),i=s(n),u=s(i,!0);r(i);var p=l(i,2),b=s(p),E=l(s(b),2);G(E),r(b);var z=l(b,2),m=l(s(z),2),I=s(m);I.value=I.__value="sub";var f=l(I);f.value=f.__value="main";var M=l(f);M.value=M.__value="datathon";var q=l(M);q.value=q.__value="ideathon",r(m),r(z);var A=l(z,2),y=l(s(A),2);G(y),r(A);var g=l(A,2),C=l(s(g),2);G(C),r(g);var B=l(g,2),w=s(B);w.__click=()=>o(se,!1);var P=l(w,2),U=s(P,!0);r(P),r(B),r(p),r(n),r(a),D(()=>{x(u,e(Z)?"í€˜ìŠ¤íŠ¸ ìˆ˜ì •":"í€˜ìŠ¤íŠ¸ ì¶”ê°€"),P.disabled=e(xe),x(U,e(xe)?"ì €ì¥ ì¤‘...":e(Z)?"ìˆ˜ì •":"ì¶”ê°€")}),qr("submit",p,k=>{k.preventDefault(),Zt()}),W(E,()=>e(oe),k=>o(oe,k)),st(m,()=>e(le),k=>o(le,k)),W(y,()=>e(ie),k=>o(ie,k)),W(C,()=>e(ne),k=>o(ne,k)),v(t,a)};N(Mt,t=>{e(se)&&t(cr)})}var vr=l(Mt,2);{var pr=t=>{var a=ta(),n=s(a),i=l(s(n),4),u=s(i),p=l(s(u),2);G(p),r(u);var b=l(u,2),E=l(s(b),2);G(E),tt(2),r(b);var z=l(b,2);{var m=y=>{var g=ea(),C=s(g),B=l(C,2),w=l(s(B),2),P=s(w);r(w);var U=l(w,4),k=s(U);r(U);var S=l(U,4),F=s(S);r(S);var ke=l(S,4),We=s(ke);r(ke),r(B);var ve=l(B,2);{var Ye=Ze=>{var He=Xr(),Je=s(He),br=s(Je);r(Je);var Tt=l(Je,2);H(Tt,21,()=>e(L).errors,J,(fr,gr)=>{var Xe=Jr(),xr=s(Xe);r(Xe),D(()=>x(xr,`Â· ${e(gr)??""}`)),v(fr,Xe)}),r(Tt),r(He),D(()=>x(br,`ì˜¤ë¥˜ (${e(L).errors.length??""}ê±´):`)),v(Ze,He)};N(ve,Ze=>{e(L).errors.length>0&&Ze(Ye)})}r(g),D(()=>{at(g,1,`rounded-lg border p-3 ${e(L).errors.length>0?"border-yellow-300 bg-yellow-50":"border-green-300 bg-green-50"}`),at(C,1,`text-sm font-medium ${e(L).errors.length>0?"text-yellow-800":"text-green-800"} mb-2`),x(P,`${e(L).quests_created??""}ê°œ`),x(k,`${e(L).quests_updated??""}ê°œ`),x(F,`${e(L).scores_created??""}ê°œ`),x(We,`${e(L).scores_updated??""}ê°œ`)}),v(y,g)};N(z,y=>{e(L)&&y(m)})}var I=l(z,2),f=s(I);f.__click=()=>o(Me,!1);var M=s(f,!0);r(f);var q=l(f,2);q.__click=Wt;var A=s(q,!0);r(q),r(I),r(i),r(n),r(a),D(y=>{x(M,e(L)?"ë‹«ê¸°":"ì·¨ì†Œ"),q.disabled=y,x(A,e(me)?"ê°€ì ¸ì˜¤ëŠ” ì¤‘...":"ê°€ì ¸ì˜¤ê¸°")},[()=>e(me)||!e(de).trim()]),W(p,()=>e(de),y=>o(de,y)),W(E,()=>e(_e),y=>o(_e,y)),v(t,a)};N(vr,t=>{e(Me)&&t(pr)})}D(()=>{$e.disabled=e(Se),x(lr,e(Se)?"ë¶€ì—¬ ì¤‘...":"+ ë¶€ì—¬")}),st(Ae,()=>e(ue),t=>o(ue,t)),W(wt,()=>e(ce),t=>o(ce,t)),st(Ve,()=>e(re),t=>o(re,t)),W(Lt,()=>e(we),t=>o(we,t)),v(c,ut),Mr(),Y()}Tr(["click","input","change"]);export{ya as component};
