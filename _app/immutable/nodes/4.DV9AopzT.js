import{a as p,f as b,c as ot}from"../chunks/_V9dK3ok.js";import{o as Cr}from"../chunks/1hPTKaIJ.js";import{l as Dr,an as Rr,ai as Er,a0 as Ir,ao as Qr,ap as jr,n as ie,o as zr,p as Ar,b as u,d as V,f as J,e as o,t as q,g as t,a as Br,c as a,s as l,h as Oe,q as gt,r}from"../chunks/CcVkWGgp.js";import{d as Or,s as f,e as Ur}from"../chunks/Dap9sqf4.js";import{i as M}from"../chunks/BSGnc2-w.js";import{e as G,i as K}from"../chunks/GjfVCmik.js";import{a as S,r as F,s as ne,c as Nr}from"../chunks/By8uYFO7.js";import{s as mt}from"../chunks/CWDCDM9S.js";import{b as W}from"../chunks/CZzPbpj5.js";import{s as Pr,a as Gr}from"../chunks/Dn1l8nLM.js";import{p as Kr}from"../chunks/BN37D8cj.js";import{g as Ue}from"../chunks/LoNY-kA5.js";import{b as Ne}from"../chunks/BqdsdljB.js";import{a as E}from"../chunks/7tRFSso3.js";import{i as Fr}from"../chunks/3jTL0Oy-.js";import{Q as Vr}from"../chunks/DqiXTygU.js";import{L as Wr}from"../chunks/C0NRKcx4.js";function Pe(x,I,X=!1){if(x.multiple){if(I==null)return;if(!Ir(I))return Qr();for(var O of x.options)O.selected=I.includes(yt(O));return}for(O of x.options){var Y=yt(O);if(jr(Y,I)){O.selected=!0;return}}(!X||I!==void 0)&&(x.selectedIndex=-1)}function Yr(x){var I=new MutationObserver(()=>{Pe(x,x.__value)});I.observe(x,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Er(()=>{I.disconnect()})}function de(x,I,X=I){var O=new WeakSet,Y=!0;Dr(x,"change",B=>{var N=B?"[selected]":":checked",$;if(x.multiple)$=[].map.call(x.querySelectorAll(N),yt);else{var tt=x.querySelector(N)??x.querySelector("option:not([disabled])");$=tt&&yt(tt)}X($),ie!==null&&O.add(ie)}),Rr(()=>{var B=I();if(x===document.activeElement){var N=zr??ie;if(O.has(N))return}if(Pe(x,B,Y),Y&&B===void 0){var $=x.querySelector(":checked");$!==null&&(B=yt($),X(B))}x.__value=B,Y=!1}),Yr(x)}function yt(x){return"__value"in x?x.__value:x.value}var Zr=b('<th class="px-2 py-2 text-center min-w-[130px]"><div class="flex flex-col items-center gap-1"><button class="text-xs font-semibold text-gray-700 hover:text-blue-700 cursor-pointer"> </button></div></th>'),Hr=b('<tr><td class="px-3 py-6 text-center text-gray-500">ì ìˆ˜í‘œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</td></tr>'),Jr=b('<tr><td class="px-3 py-6 text-center text-gray-500">ì—´ ë + ë²„íŠ¼ìœ¼ë¡œ í€˜ìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.</td></tr>'),Xr=b('<span class="text-[10px] text-blue-500">ì €ì¥</span>'),ta=b('<span class="text-[10px] text-red-500">ì‹¤íŒ¨</span>'),ea=b('<td class="px-2 py-2"><div class="flex items-center justify-center gap-1"><input type="text" inputmode="decimal" placeholder="-"/> <!></div></td>'),ra=b('<tr class="hover:bg-gray-50/70"><td class="sticky left-0 z-10 bg-white px-3 py-2 font-medium text-gray-800"> </td><!><td class="px-2 py-2"></td></tr>'),aa=b("<option> </option>"),sa=b("<option> </option>"),oa=b('<input type="text" placeholder="ì¹´í…Œê³ ë¦¬ ì…ë ¥" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/>'),la=b('<div class="text-center py-8 text-gray-400 text-sm">ë¶€ì—¬ëœ ë¹„ì •ê·œ ì ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</div>'),ia=b('<tr class="hover:bg-gray-50"><td class="px-3 py-2 font-medium text-gray-800 max-w-full lg:max-w-[80px] truncate"> </td><td class="px-3 py-2 text-center font-bold text-green-600"> </td><td class="px-3 py-2 text-xs text-gray-800 max-w-full lg:max-w-[80px] truncate"> </td><td class="px-3 py-2 text-gray-600 max-w-full lg:max-w-[100px] truncate"> </td><td class="px-3 py-2 text-center"><button class="text-red-400 hover:text-red-600 cursor-pointer text-xs">ì‚­ì œ</button></td></tr>'),na=b('<div class="bg-white rounded-lg border border-gray-200 overflow-hidden"><div class="max-h-[calc(100vh-400px)] overflow-y-auto"><table class="w-full text-sm"><thead class="bg-gray-50 sticky top-0"><tr><th class="px-3 py-2 text-left text-xs font-medium text-gray-500">í•™ìƒ</th><th class="px-3 py-2 text-center text-xs font-medium text-gray-500">ì ìˆ˜</th><th class="px-3 py-2 text-left text-xs font-medium text-gray-500">ì¹´í…Œê³ ë¦¬</th><th class="px-3 py-2 text-left text-xs font-medium text-gray-500">ì‚¬ìœ </th><th class="px-3 py-2 text-center text-xs font-medium text-gray-500 w-10"></th></tr></thead><tbody class="divide-y divide-gray-100"></tbody></table></div></div>'),da=b('<div class="p-4 text-center text-gray-500 text-sm">í™œì„± í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤.</div>'),ua=b('<li class="px-4 py-3 flex items-center justify-between gap-3 hover:bg-gray-50"><button class="text-left min-w-0 flex-1 group cursor-pointer"><span class="font-medium text-gray-800 block truncate"> </span> <span class="text-xs text-gray-400 group-hover:text-blue-600">ìƒì„¸ë³´ê¸° &rarr;</span></button> <button class="shrink-0 px-3 py-1.5 text-xs font-medium rounded-md border border-red-200 text-red-600 hover:bg-red-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors cursor-pointer"> </button></li>'),ca=b('<ul class="divide-y divide-gray-100"></ul>'),va=b('<div class="p-4 text-center text-gray-500 text-sm">ë¹„í™œì„± í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤.</div>'),pa=b('<li class="px-4 py-3 flex items-center justify-between gap-3 hover:bg-gray-50"><button class="text-left min-w-0 flex-1 group cursor-pointer"><span class="font-medium text-gray-800 block truncate"> </span> <span class="text-xs text-gray-400 group-hover:text-blue-600">ìƒì„¸ë³´ê¸° &rarr;</span></button> <button class="shrink-0 px-3 py-1.5 text-xs font-medium rounded-md border border-green-200 text-green-700 hover:bg-green-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors cursor-pointer"> </button></li>'),_a=b('<ul class="divide-y divide-gray-100"></ul>'),xa=b('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40"><div class="bg-white rounded-xl shadow-xl w-full max-w-md mx-4 p-6"><h2 class="text-lg font-bold text-gray-800 mb-4"> </h2> <form class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">í€˜ìŠ¤íŠ¸ ë²ˆí˜¸</label> <input type="number" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ìœ í˜•</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"><option>ì„œë¸Œí€˜ìŠ¤íŠ¸ (0~1)</option><option>ë©”ì¸í€˜ìŠ¤íŠ¸ (0~5)</option><option>ë°ì´í„°í†¤ (0~10)</option><option>ì•„ì´ë””ì–´í†¤ (0~20)</option></select></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ì œëª© (ì„ íƒ)</label> <input type="text" placeholder="ì˜ˆ: ë¨¸ì‹ ëŸ¬ë‹ ê¸°ì´ˆ" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ë‚ ì§œ</label> <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div class="flex gap-2 pt-2"><button type="button" class="flex-1 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 cursor-pointer">ì·¨ì†Œ</button> <button type="submit" class="flex-1 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 disabled:opacity-50 cursor-pointer"> </button></div></form></div></div>'),fa=b("<li> </li>"),ba=b('<div class="mt-2 pt-2 border-t border-yellow-200"><p class="text-xs font-medium text-yellow-700 mb-1"> </p> <ul class="text-xs text-yellow-600 space-y-0.5 max-h-24 overflow-y-auto"></ul></div>'),ga=b('<div><p>ê°€ì ¸ì˜¤ê¸° ê²°ê³¼</p> <div class="grid grid-cols-2 gap-1 text-xs"><span class="text-gray-600">í€˜ìŠ¤íŠ¸ ìƒì„±:</span> <span class="font-medium"> </span> <span class="text-gray-600">í€˜ìŠ¤íŠ¸ ê°±ì‹ :</span> <span class="font-medium"> </span> <span class="text-gray-600">ì ìˆ˜ ìƒì„±:</span> <span class="font-medium"> </span> <span class="text-gray-600">ì ìˆ˜ ê°±ì‹ :</span> <span class="font-medium"> </span></div> <!></div>'),ma=b('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40"><div class="bg-white rounded-xl shadow-xl w-full max-w-lg mx-4 p-6"><h2 class="text-lg font-bold text-gray-800 mb-1">ğŸ“¥ ì‹œíŠ¸ì—ì„œ í€˜ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°</h2> <p class="text-xs text-gray-500 mb-4">Google ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì˜ "í€˜ìŠ¤íŠ¸" ì‹œíŠ¸ì—ì„œ í€˜ìŠ¤íŠ¸ ëª©ë¡ê³¼ ì ìˆ˜ë¥¼ ìë™ìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.</p> <div class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">ìŠ¤í”„ë ˆë“œì‹œíŠ¸ URL ë˜ëŠ” ID</label> <input type="text" placeholder="https://docs.google.com/spreadsheets/d/... ë˜ëŠ” ID" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ì‹œíŠ¸ ì´ë¦„</label> <input type="text" placeholder="í€˜ìŠ¤íŠ¸" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500"/> <p class="text-xs text-gray-400 mt-1">ê¸°ë³¸ê°’: "í€˜ìŠ¤íŠ¸"</p></div> <!> <div class="flex gap-2 pt-2"><button type="button" class="flex-1 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 cursor-pointer"> </button> <button type="button" class="flex-1 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 disabled:opacity-50 cursor-pointer"> </button></div></div></div></div>'),ya=b('<div class="max-w-[1600px] mx-auto px-3 py-6 sm:px-6"><div class="mb-6"><button class="text-sm text-blue-600 hover:text-blue-800 mb-2 cursor-pointer">â† ê³¼ì • ëª©ë¡</button> <h1 class="text-2xl font-bold text-gray-800">í€˜ìŠ¤íŠ¸ ê´€ë¦¬</h1></div> <div class="flex flex-col lg:flex-row gap-6 items-start"><div class="flex-1 min-w-0"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-4"><h2 class="text-lg font-semibold text-gray-700">í•™ìƒ x í€˜ìŠ¤íŠ¸ ì ìˆ˜í‘œ</h2> <div class="flex flex-col sm:flex-row gap-2"><button class="px-3 py-2 text-sm border border-green-600 text-green-700 rounded-lg hover:bg-green-50 transition-colors cursor-pointer">ğŸ“¥ ì‹œíŠ¸ì—ì„œ ê°€ì ¸ì˜¤ê¸°</button> <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer">+ í€˜ìŠ¤íŠ¸ ì¶”ê°€</button></div></div> <div class="rounded-lg border border-gray-200 bg-white overflow-hidden mb-3"><div class="overflow-auto"><table class="w-full min-w-[980px] text-sm"><thead class="bg-gray-50 border-b border-gray-200"><tr><th class="sticky left-0 z-10 bg-gray-50 px-3 py-2 text-left font-medium text-gray-600 min-w-[170px]">í•™ìƒ</th><!><th class="px-2 py-2 text-center min-w-[70px]"><button class="w-8 h-8 rounded-md border border-dashed border-gray-300 text-gray-500 hover:text-blue-600 hover:border-blue-400 cursor-pointer">+</button></th></tr></thead><tbody class="divide-y divide-gray-100"><!></tbody></table></div></div> <!></div> <div class="w-full lg:w-[380px] flex-shrink-0 lg:sticky lg:top-6"><h2 class="text-lg font-semibold text-gray-700 mb-4">ë¹„ì •ê·œ ì ìˆ˜ ê´€ë¦¬</h2> <div class="bg-white rounded-lg border border-gray-200 p-4 mb-4"><h3 class="text-sm font-medium text-gray-700 mb-3">ë¹„ì •ê·œ ì ìˆ˜ ë¶€ì—¬</h3> <div class="space-y-3"><div><label class="block text-xs text-gray-500 mb-1">í•™ìƒ</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"><option>í•™ìƒ ì„ íƒ</option><!></select></div> <div class="flex flex-col sm:flex-row gap-3"><div class="w-20"><label class="block text-xs text-gray-500 mb-1">ì ìˆ˜</label> <input type="number" step="0.5" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div class="flex-1 space-y-2"><div><label class="block text-xs text-gray-500 mb-1">ì¹´í…Œê³ ë¦¬</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></select></div> <!> <div><input type="text" placeholder="ìƒì„¸ ì‚¬ìœ  (ì„ íƒ)" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div></div></div> <button class="w-full px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors cursor-pointer"> </button></div></div> <!></div> <div class="mt-6"><h2 class="text-lg font-semibold text-gray-700 mb-4">í•™ìƒ ëª©ë¡</h2> <div class="bg-white rounded-lg border border-gray-200 overflow-hidden"><div class="border-b border-gray-200 overflow-x-auto"><div class="flex min-w-max"><button> </button> <button> </button></div></div> <div class="max-h-[300px] overflow-y-auto"><!></div></div></div></div></div> <!> <!>',1);function Aa(x,I){Ar(I,!0);const X=()=>Gr(Fr,"$isLoggedIn",O),[O,Y]=Pr();let B=u(!0),N=u(V([])),$=Oe(()=>Kr.params.courseId),tt=u(!1),lt=u(V({}));const ue=new Map;let et=Oe(()=>[...t(N)].sort((e,s)=>e.quest_number-s.quest_number));function ht(e,s){return`${e}:${s}`}function rt(e,s){return t(lt)[ht(e,s)]||{score:"",isSubmitted:!1,saving:!1,error:!1}}function wt(e,s,i){const n=ht(e,s);o(lt,{...t(lt),[n]:{...rt(e,s),...i}},!0)}let it=u(!1),kt=u(!1),nt=u(1),dt=u("main"),ut=u(""),ct=u(V(new Date().toISOString().split("T")[0])),Z=u(null),Ge=u(V(new Set)),Et=u(!1),vt=u(""),St=u("í€˜ìŠ¤íŠ¸"),$t=u(!1),C=u(null),ce=u(V([])),H=u(V([])),Lt=u(V([])),pt=u("active"),at=u(null),It=u(V([])),Qt=u(!1),_t=u(null),xt=u(0),st=u("í¼ì‹¤ì¬ëŸ‰ì ìˆ˜"),Tt=u(""),qt=u(""),Mt=u(!1);const Ke=["í¼ì‹¤ì¬ëŸ‰ì ìˆ˜","ì•„ë‚Œì—†ì´ ì£¼ëŠ” ê·¸ë£¨","ë””ìŠ¤ì½”ë“œ ì†Œí†µì™•","ì‰ë°¸ê·¸íˆ¬","ì§ì ‘ ì…ë ¥"];let Fe=u(!1),Ve=u(null),ve=u(!1),pe=u(null);async function _e(e){o(Ve,e,!0),o(Fe,!0),o(ve,!0),o(pe,null);try{o(pe,await E.get(`/api/v1/facilitator/courses/${t($)}/students/${e.legacy_user_id}/rubrics`),!0)}catch{S("ë£¨ë¸Œë¦­ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error")}finally{o(ve,!1)}}Cr(async()=>{if(!X()){Ue(`${Ne}/login`);return}E.post(`/api/v1/admin/sync/students/${t($)}`).catch(()=>{}),await jt(),await xe(),await zt(),await At()});async function jt(){o(B,!0);try{o(N,await E.get(`/api/v1/facilitator/courses/${t($)}/quests`),!0),o(Ge,new Set,!0)}catch{S("í€˜ìŠ¤íŠ¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error")}finally{o(B,!1)}}async function xe(){try{const[e,s]=await Promise.all([E.get(`/api/v1/facilitator/courses/${t($)}/students?active=true`),E.get(`/api/v1/facilitator/courses/${t($)}/students?active=false`)]);o(H,e,!0),o(Lt,s,!0),o(ce,e,!0)}catch{}}async function zt(){if(t(et).length===0||t(H).length===0){o(lt,{},!0);return}o(tt,!0);try{const e={};await Promise.all(t(et).map(async s=>{const i=await E.get(`/api/v1/facilitator/quests/${s.id}/students`);for(const n of i)t(H).find(c=>c.legacy_user_id===n.legacy_student_id)&&(e[ht(n.legacy_student_id,s.id)]={score:n.score===null?"":String(n.score),isSubmitted:n.is_submitted,saving:!1,error:!1})})),o(lt,e,!0)}catch{S("ì ìˆ˜ ë§¤íŠ¸ë¦­ìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.","error")}finally{o(tt,!1)}}function We(e,s,i){const n=i.trim();n!==""&&!/^\d+(\.\d+)?$/.test(n)||(wt(e,s.id,{score:n,isSubmitted:n!=="",error:!1}),Ye(e,s.id,s.quest_type))}function Ye(e,s,i){const n=ht(e,s),c=ue.get(n);c&&clearTimeout(c),ue.set(n,setTimeout(()=>{Ze(e,s)},450))}async function Ze(e,s,i){const n=rt(e,s);wt(e,s,{saving:!0,error:!1});try{const c=n.score===""?null:Number(n.score);await E.post(`/api/v1/facilitator/quests/${s}/scores`,{scores:[{legacy_student_id:e,score:c,is_submitted:c!==null}]}),wt(e,s,{saving:!1,error:!1,isSubmitted:c!==null})}catch{wt(e,s,{saving:!1,error:!0}),S("ì ìˆ˜ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}}async function fe(e){o(at,e,!0);try{const s=await E.patch(`/api/v1/facilitator/courses/${t($)}/students/${e}/active`);S(s.is_active?"í•™ìƒì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.":"í•™ìƒì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.","success"),await xe()}catch{S("í•™ìƒ ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{o(at,null)}}async function At(){o(Qt,!0);try{o(It,await E.get(`/api/v1/facilitator/courses/${t($)}/bonus-scores`),!0)}catch{S("ë¹„ì •ê·œ ì ìˆ˜ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error")}finally{o(Qt,!1)}}async function He(){let e=t(st);if(t(st)==="ì§ì ‘ ì…ë ¥"&&(e=t(Tt).trim()),!t(_t)||t(xt)<=0||!e){S("í•™ìƒ, ì ìˆ˜, ì¹´í…Œê³ ë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.","error");return}o(Mt,!0);try{await E.post(`/api/v1/facilitator/courses/${t($)}/bonus-scores`,{legacy_student_id:t(_t),score:t(xt),category:e,reason:t(qt).trim()}),S("ë¹„ì •ê·œ ì ìˆ˜ê°€ ë¶€ì—¬ë˜ì—ˆìŠµë‹ˆë‹¤.","success"),o(_t,null),o(xt,0),o(qt,""),o(st,"í¼ì‹¤ì¬ëŸ‰ì ìˆ˜"),o(Tt,""),await At()}catch{S("ë¹„ì •ê·œ ì ìˆ˜ ë¶€ì—¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{o(Mt,!1)}}async function Je(e){if(confirm("ì´ ë¹„ì •ê·œ ì ìˆ˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{await E.del(`/api/v1/facilitator/bonus-scores/${e}`),S("ë¹„ì •ê·œ ì ìˆ˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.","success"),await At()}catch{S("ë¹„ì •ê·œ ì ìˆ˜ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}}function Xe(e){const s=e.match(/\/spreadsheets\/d\/([a-zA-Z0-9_-]+)/);return s?s[1]:e.trim()}function tr(){o(vt,""),o(St,"í€˜ìŠ¤íŠ¸"),o(C,null),o(Et,!0)}async function er(){const e=Xe(t(vt));if(!e){S("ìŠ¤í”„ë ˆë“œì‹œíŠ¸ URL ë˜ëŠ” IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.","error");return}o($t,!0),o(C,null);try{const s=await E.post(`/api/v1/facilitator/courses/${t($)}/import-sheet`,{spreadsheet_id:e,sheet_name:t(St).trim()||"í€˜ìŠ¤íŠ¸"});o(C,s,!0),S(`ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ: í€˜ìŠ¤íŠ¸ ${s.quests_created}ê°œ ìƒì„±, ${s.quests_updated}ê°œ ê°±ì‹  / ì ìˆ˜ ${s.scores_created}ê°œ ìƒì„±, ${s.scores_updated}ê°œ ê°±ì‹ `,s.errors.length>0?"error":"success"),await jt(),await zt()}catch{S("ì‹œíŠ¸ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{o($t,!1)}}function be(){o(Z,null),o(nt,t(N).length>0?Math.max(...t(N).map(e=>e.quest_number))+1:1,!0),o(dt,"main"),o(ut,""),o(ct,new Date().toISOString().split("T")[0],!0),o(it,!0)}function rr(e){o(Z,e,!0),o(nt,e.quest_number,!0),o(dt,e.quest_type,!0),o(ut,e.title||"",!0),o(ct,e.quest_date,!0),o(it,!0)}async function ar(){o(kt,!0);try{const e={quest_number:t(nt),quest_type:t(dt),title:t(ut).trim()||null,quest_date:t(ct)};t(Z)?(await E.put(`/api/v1/facilitator/quests/${t(Z).id}`,e),S("í€˜ìŠ¤íŠ¸ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.","success")):(await E.post(`/api/v1/facilitator/courses/${t($)}/quests`,e),S("í€˜ìŠ¤íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.","success")),o(it,!1),await jt(),await zt()}catch{S(t(Z)?"í€˜ìŠ¤íŠ¸ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.":"í€˜ìŠ¤íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{o(kt,!1)}}var ge=ya(),Bt=J(ge),Ot=a(Bt),sr=a(Ot);sr.__click=()=>Ue(`${Ne}/facilitator`),gt(2),r(Ot);var me=l(Ot,2),Ut=a(me),Nt=a(Ut),ye=l(a(Nt),2),he=a(ye);he.__click=tr;var or=l(he,2);or.__click=be,r(ye),r(Nt);var Pt=l(Nt,2),we=a(Pt),ke=a(we),Gt=a(ke),Se=a(Gt),$e=l(a(Se));G($e,17,()=>t(et),K,(e,s)=>{var i=Zr(),n=a(i),c=a(n);c.__click=()=>rr(t(s));var d=a(c,!0);r(c),r(n),r(i),q(()=>f(d,t(s).title||`${Vr[t(s).quest_type]} #${t(s).quest_number}`)),p(e,i)});var Le=l($e),lr=a(Le);lr.__click=be,r(Le),r(Se),r(Gt);var Te=l(Gt),ir=a(Te);{var nr=e=>{var s=Hr(),i=a(s);r(s),q(()=>ne(i,"colspan",t(et).length+2)),p(e,s)},dr=e=>{var s=ot(),i=J(s);{var n=d=>{var v=Jr(),L=a(v);ne(L,"colspan",2),r(v),p(d,v)},c=d=>{var v=ot(),L=J(v);G(L,17,()=>t(H),K,(m,y)=>{var w=ra(),_=a(w),T=a(_,!0);r(_);var h=l(_);G(h,17,()=>t(et),K,(Q,k)=>{var D=ea(),j=a(D),R=a(j);F(R),R.__input=g=>We(t(y).legacy_user_id,t(k),g.currentTarget.value);var z=l(R,2);{var P=g=>{var A=Xr();p(g,A)},U=g=>{var A=ot(),ee=J(A);{var Rt=bt=>{var re=ta();p(bt,re)};M(ee,bt=>{rt(t(y).legacy_user_id,t(k).id).error&&bt(Rt)},!0)}p(g,A)};M(z,g=>{rt(t(y).legacy_user_id,t(k).id).saving?g(P):g(U,!1)})}r(j),r(D),q((g,A)=>{Nr(R,g),mt(R,1,A)},[()=>rt(t(y).legacy_user_id,t(k).id).score,()=>`w-16 px-2 py-1 text-center border rounded text-sm focus:outline-none focus:ring-2 ${rt(t(y).legacy_user_id,t(k).id).error?"border-red-400 focus:ring-red-200":"border-gray-300 focus:ring-blue-200"}`]),p(Q,D)}),gt(),r(w),q(()=>f(T,t(y).name)),p(m,w)}),p(d,v)};M(i,d=>{t(et).length===0?d(n):d(c,!1)},!0)}p(e,s)};M(ir,e=>{t(B)||t(tt)?e(nr):e(dr,!1)})}r(Te),r(ke),r(we),r(Pt);var ur=l(Pt,2);M(ur,e=>{}),r(Ut);var Kt=l(Ut,2),Ft=l(a(Kt),2),qe=l(a(Ft),2),Vt=a(qe),Wt=l(a(Vt),2),Yt=a(Wt);Yt.value=(Yt.__value=null)??"";var cr=l(Yt);G(cr,17,()=>t(ce),K,(e,s)=>{var i=aa(),n=a(i,!0);r(i);var c={};q(()=>{f(n,t(s).name),c!==(c=t(s).legacy_user_id)&&(i.value=(i.__value=t(s).legacy_user_id)??"")}),p(e,i)}),r(Wt),r(Vt);var Zt=l(Vt,2),Ht=a(Zt),Me=l(a(Ht),2);F(Me),r(Ht);var Ce=l(Ht,2),Jt=a(Ce),Xt=l(a(Jt),2);G(Xt,21,()=>Ke,K,(e,s)=>{var i=sa(),n=a(i,!0);r(i);var c={};q(()=>{f(n,t(s)),c!==(c=t(s))&&(i.value=(i.__value=t(s))??"")}),p(e,i)}),r(Xt),r(Jt);var De=l(Jt,2);{var vr=e=>{var s=oa();F(s),W(s,()=>t(Tt),i=>o(Tt,i)),p(e,s)};M(De,e=>{t(st)==="ì§ì ‘ ì…ë ¥"&&e(vr)})}var Re=l(De,2),Ee=a(Re);F(Ee),r(Re),r(Ce),r(Zt);var Ct=l(Zt,2);Ct.__click=He;var pr=a(Ct,!0);r(Ct),r(qe),r(Ft);var _r=l(Ft,2);{var xr=e=>{Wr(e,{type:"card",lines:3})},fr=e=>{var s=ot(),i=J(s);{var n=d=>{var v=la();p(d,v)},c=d=>{var v=na(),L=a(v),m=a(L),y=l(a(m));G(y,21,()=>t(It),K,(w,_)=>{var T=ia(),h=a(T),Q=a(h,!0);r(h);var k=l(h),D=a(k);r(k);var j=l(k),R=a(j,!0);r(j);var z=l(j),P=a(z,!0);r(z);var U=l(z),g=a(U);g.__click=()=>Je(t(_).id),r(U),r(T),q(A=>{ne(T,"title",`${t(_).given_by_name??""} Â· ${A??""}`),f(Q,t(_).student_name),f(D,`+${t(_).score??""}`),f(R,t(_).category),f(P,t(_).reason)},[()=>new Date(t(_).given_at).toLocaleDateString("ko-KR")]),p(w,T)}),r(y),r(m),r(L),r(v),p(d,v)};M(i,d=>{t(It).length===0?d(n):d(c,!1)},!0)}p(e,s)};M(_r,e=>{t(Qt)?e(xr):e(fr,!1)})}r(Kt);var Ie=l(Kt,2),Qe=l(a(Ie),2),te=a(Qe),je=a(te),ft=a(je);ft.__click=()=>o(pt,"active");var br=a(ft);r(ft);var Dt=l(ft,2);Dt.__click=()=>o(pt,"inactive");var gr=a(Dt);r(Dt),r(je),r(te);var ze=l(te,2),mr=a(ze);{var yr=e=>{var s=ot(),i=J(s);{var n=d=>{var v=da();p(d,v)},c=d=>{var v=ca();G(v,21,()=>t(H),K,(L,m)=>{var y=ua(),w=a(y);w.__click=()=>_e(t(m));var _=a(w),T=a(_,!0);r(_),gt(2),r(w);var h=l(w,2);h.__click=()=>fe(t(m).legacy_user_id);var Q=a(h,!0);r(h),r(y),q(()=>{f(T,t(m).name),h.disabled=t(at)===t(m).legacy_user_id,f(Q,t(at)===t(m).legacy_user_id?"ì²˜ë¦¬ì¤‘...":"ë¹„í™œì„±í™”")}),p(L,y)}),r(v),p(d,v)};M(i,d=>{t(H).length===0?d(n):d(c,!1)})}p(e,s)},hr=e=>{var s=ot(),i=J(s);{var n=d=>{var v=va();p(d,v)},c=d=>{var v=_a();G(v,21,()=>t(Lt),K,(L,m)=>{var y=pa(),w=a(y);w.__click=()=>_e(t(m));var _=a(w),T=a(_,!0);r(_),gt(2),r(w);var h=l(w,2);h.__click=()=>fe(t(m).legacy_user_id);var Q=a(h,!0);r(h),r(y),q(()=>{f(T,t(m).name),h.disabled=t(at)===t(m).legacy_user_id,f(Q,t(at)===t(m).legacy_user_id?"ì²˜ë¦¬ì¤‘...":"í™œì„±í™”")}),p(L,y)}),r(v),p(d,v)};M(i,d=>{t(Lt).length===0?d(n):d(c,!1)})}p(e,s)};M(mr,e=>{t(pt)==="active"?e(yr):e(hr,!1)})}r(ze),r(Qe),r(Ie),r(me),r(Bt);var Ae=l(Bt,2);{var wr=e=>{var s=xa(),i=a(s),n=a(i),c=a(n,!0);r(n);var d=l(n,2),v=a(d),L=l(a(v),2);F(L),r(v);var m=l(v,2),y=l(a(m),2),w=a(y);w.value=w.__value="sub";var _=l(w);_.value=_.__value="main";var T=l(_);T.value=T.__value="datathon";var h=l(T);h.value=h.__value="ideathon",r(y),r(m);var Q=l(m,2),k=l(a(Q),2);F(k),r(Q);var D=l(Q,2),j=l(a(D),2);F(j),r(D);var R=l(D,2),z=a(R);z.__click=()=>o(it,!1);var P=l(z,2),U=a(P,!0);r(P),r(R),r(d),r(i),r(s),q(()=>{f(c,t(Z)?"í€˜ìŠ¤íŠ¸ ìˆ˜ì •":"í€˜ìŠ¤íŠ¸ ì¶”ê°€"),P.disabled=t(kt),f(U,t(kt)?"ì €ì¥ ì¤‘...":t(Z)?"ìˆ˜ì •":"ì¶”ê°€")}),Ur("submit",d,g=>{g.preventDefault(),ar()}),W(L,()=>t(nt),g=>o(nt,g)),de(y,()=>t(dt),g=>o(dt,g)),W(k,()=>t(ut),g=>o(ut,g)),W(j,()=>t(ct),g=>o(ct,g)),p(e,s)};M(Ae,e=>{t(it)&&e(wr)})}var kr=l(Ae,2);{var Sr=e=>{var s=ma(),i=a(s),n=l(a(i),4),c=a(n),d=l(a(c),2);F(d),r(c);var v=l(c,2),L=l(a(v),2);F(L),gt(2),r(v);var m=l(v,2);{var y=k=>{var D=ga(),j=a(D),R=l(j,2),z=l(a(R),2),P=a(z);r(z);var U=l(z,4),g=a(U);r(U);var A=l(U,4),ee=a(A);r(A);var Rt=l(A,4),bt=a(Rt);r(Rt),r(R);var re=l(R,2);{var $r=ae=>{var se=ba(),oe=a(se),Lr=a(oe);r(oe);var Be=l(oe,2);G(Be,21,()=>t(C).errors,K,(Tr,qr)=>{var le=fa(),Mr=a(le);r(le),q(()=>f(Mr,`Â· ${t(qr)??""}`)),p(Tr,le)}),r(Be),r(se),q(()=>f(Lr,`ì˜¤ë¥˜ (${t(C).errors.length??""}ê±´):`)),p(ae,se)};M(re,ae=>{t(C).errors.length>0&&ae($r)})}r(D),q(()=>{mt(D,1,`rounded-lg border p-3 ${t(C).errors.length>0?"border-yellow-300 bg-yellow-50":"border-green-300 bg-green-50"}`),mt(j,1,`text-sm font-medium ${t(C).errors.length>0?"text-yellow-800":"text-green-800"} mb-2`),f(P,`${t(C).quests_created??""}ê°œ`),f(g,`${t(C).quests_updated??""}ê°œ`),f(ee,`${t(C).scores_created??""}ê°œ`),f(bt,`${t(C).scores_updated??""}ê°œ`)}),p(k,D)};M(m,k=>{t(C)&&k(y)})}var w=l(m,2),_=a(w);_.__click=()=>o(Et,!1);var T=a(_,!0);r(_);var h=l(_,2);h.__click=er;var Q=a(h,!0);r(h),r(w),r(n),r(i),r(s),q(k=>{f(T,t(C)?"ë‹«ê¸°":"ì·¨ì†Œ"),h.disabled=k,f(Q,t($t)?"ê°€ì ¸ì˜¤ëŠ” ì¤‘...":"ê°€ì ¸ì˜¤ê¸°")},[()=>t($t)||!t(vt).trim()]),W(d,()=>t(vt),k=>o(vt,k)),W(L,()=>t(St),k=>o(St,k)),p(e,s)};M(kr,e=>{t(Et)&&e(Sr)})}q(()=>{Ct.disabled=t(Mt),f(pr,t(Mt)?"ë¶€ì—¬ ì¤‘...":"+ ë¶€ì—¬"),mt(ft,1,`px-4 py-2.5 text-sm font-medium border-b-2 transition-colors cursor-pointer ${t(pt)==="active"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`),f(br,`í™œì„± í•™ìƒ (${t(H).length??""})`),mt(Dt,1,`px-4 py-2.5 text-sm font-medium border-b-2 transition-colors cursor-pointer ${t(pt)==="inactive"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`),f(gr,`ë¹„í™œì„± í•™ìƒ (${t(Lt).length??""})`)}),de(Wt,()=>t(_t),e=>o(_t,e)),W(Me,()=>t(xt),e=>o(xt,e)),de(Xt,()=>t(st),e=>o(st,e)),W(Ee,()=>t(qt),e=>o(qt,e)),p(x,ge),Br(),Y()}Or(["click","input","change"]);export{Aa as component};
