import{a as v,f as m,c as Te}from"../chunks/_V9dK3ok.js";import{o as fr}from"../chunks/1hPTKaIJ.js";import{l as gr,an as xr,ai as _r,a0 as mr,ao as yr,ap as hr,n as et,o as wr,p as Sr,b as u,d as V,f as fe,t as D,g as e,a as $r,e as l,c as s,s as o,h as Mt,q as tt,r as a}from"../chunks/CcVkWGgp.js";import{d as kr,s as g,e as Lr}from"../chunks/Dap9sqf4.js";import{i as Q}from"../chunks/BSGnc2-w.js";import{e as ee,i as te}from"../chunks/GjfVCmik.js";import{a as S,r as G,s as rt,c as Tr}from"../chunks/By8uYFO7.js";import{s as at}from"../chunks/CWDCDM9S.js";import{b as W}from"../chunks/CZzPbpj5.js";import{s as Nr,a as Mr}from"../chunks/Dn1l8nLM.js";import{p as qr}from"../chunks/DnrdgLji.js";import{g as st}from"../chunks/CSK99l_W.js";import{b as ot}from"../chunks/CZzCSeUk.js";import{a as E}from"../chunks/Bd7vIiTM.js";import{i as Cr}from"../chunks/3jTL0Oy-.js";import{Q as Dr}from"../chunks/DqiXTygU.js";import{L as Qr}from"../chunks/C0NRKcx4.js";function qt(c,N,re=!1){if(c.multiple){if(N==null)return;if(!mr(N))return yr();for(var U of c.options)U.selected=N.includes(ge(U));return}for(U of c.options){var Y=ge(U);if(hr(Y,N)){U.selected=!0;return}}(!re||N!==void 0)&&(c.selectedIndex=-1)}function Ir(c){var N=new MutationObserver(()=>{qt(c,c.__value)});N.observe(c,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),_r(()=>{N.disconnect()})}function lt(c,N,re=N){var U=new WeakSet,Y=!0;gr(c,"change",B=>{var P=B?"[selected]":":checked",h;if(c.multiple)h=[].map.call(c.querySelectorAll(P),ge);else{var ae=c.querySelector(P)??c.querySelector("option:not([disabled])");h=ae&&ge(ae)}re(h),et!==null&&U.add(et)}),xr(()=>{var B=N();if(c===document.activeElement){var P=wr??et;if(U.has(P))return}if(qt(c,B,Y),Y&&B===void 0){var h=c.querySelector(":checked");h!==null&&(B=ge(h),re(B))}c.__value=B,Y=!1}),Ir(c)}function ge(c){return"__value"in c?c.__value:c.value}var Rr=m('<th class="px-1 py-1 text-center min-w-[120px] border-r border-b border-gray-300"><div class="flex flex-col items-center gap-1"><button class="text-xs font-semibold text-gray-700 hover:text-blue-700 cursor-pointer"> </button></div></th>'),zr=m('<tr><td class="px-3 py-6 text-center text-gray-500">ì ìˆ˜í‘œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</td></tr>'),Er=m('<tr><td class="px-3 py-6 text-center text-gray-500">ì—´ ë + ë²„íŠ¼ìœ¼ë¡œ í€˜ìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.</td></tr>'),Br=m('<span class="absolute right-1 bottom-0.5 text-[9px] text-blue-500">ì €ì¥</span>'),Or=m('<span class="absolute right-1 bottom-0.5 text-[9px] text-red-500">ì‹¤íŒ¨</span>'),Ur=m('<td class="p-0 border-r border-gray-200 group"><div class="relative flex items-center justify-center gap-0.5 h-7"><input type="text" inputmode="decimal" placeholder="ì…ë ¥"/> <span class="absolute right-1 top-1 h-1 w-1 rounded-full bg-gray-300 group-hover:bg-blue-400"></span> <!></div></td>'),jr=m('<tr class="border-b border-gray-300 hover:bg-gray-50/70"><td class="sticky left-0 z-10 bg-white px-1 py-1 font-medium text-gray-800 border-r border-gray-300 text-center"><button class="w-full text-center hover:text-blue-700 cursor-pointer truncate max-w-[108px] mx-auto leading-tight"> </button></td><!><td class="p-0"></td><td class="sticky right-0 z-10 bg-white px-2 py-1 text-center border-l border-gray-300 font-semibold text-indigo-700"> </td></tr>'),Ar=m("<option> </option>"),Pr=m("<option> </option>"),Fr=m('<input type="text" placeholder="ì¹´í…Œê³ ë¦¬ ì…ë ¥" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/>'),Gr=m('<div class="text-center py-8 text-gray-400 text-sm bg-white rounded-lg border border-gray-200">ë¶€ì—¬ëœ ë¹„ì •ê·œ ì ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</div>'),Kr=m('<tr class="hover:bg-gray-50"><td class="px-3 py-2 font-medium text-gray-800 max-w-full lg:max-w-[80px] truncate"> </td><td class="px-3 py-2 text-center font-bold text-green-600"> </td><td class="px-3 py-2 text-xs text-gray-800 max-w-full lg:max-w-[80px] truncate"> </td><td class="px-3 py-2 text-gray-600 max-w-full lg:max-w-[100px] truncate"> </td><td class="px-3 py-2 text-center"><button class="text-red-400 hover:text-red-600 cursor-pointer text-xs">ì‚­ì œ</button></td></tr>'),Vr=m('<div class="bg-white rounded-lg border border-gray-200 overflow-hidden"><div class="max-h-[360px] overflow-y-auto"><table class="w-full text-sm"><thead class="bg-gray-50 sticky top-0"><tr><th class="px-3 py-2 text-left text-xs font-medium text-gray-500">í•™ìƒ</th><th class="px-3 py-2 text-center text-xs font-medium text-gray-500">ì ìˆ˜</th><th class="px-3 py-2 text-left text-xs font-medium text-gray-500">ì¹´í…Œê³ ë¦¬</th><th class="px-3 py-2 text-left text-xs font-medium text-gray-500">ì‚¬ìœ </th><th class="px-3 py-2 text-center text-xs font-medium text-gray-500 w-10"></th></tr></thead><tbody class="divide-y divide-gray-100"></tbody></table></div></div>'),Wr=m('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40"><div class="bg-white rounded-xl shadow-xl w-full max-w-md mx-4 p-6"><h2 class="text-lg font-bold text-gray-800 mb-4"> </h2> <form class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">í€˜ìŠ¤íŠ¸ ë²ˆí˜¸</label> <input type="number" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ìœ í˜•</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"><option>ì„œë¸Œí€˜ìŠ¤íŠ¸ (0~1)</option><option>ë©”ì¸í€˜ìŠ¤íŠ¸ (0~5)</option><option>ë°ì´í„°í†¤ (0~10)</option><option>ì•„ì´ë””ì–´í†¤ (0~20)</option></select></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ì œëª© (ì„ íƒ)</label> <input type="text" placeholder="ì˜ˆ: ë¨¸ì‹ ëŸ¬ë‹ ê¸°ì´ˆ" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ë‚ ì§œ</label> <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div class="flex gap-2 pt-2"><button type="button" class="flex-1 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 cursor-pointer">ì·¨ì†Œ</button> <button type="submit" class="flex-1 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 disabled:opacity-50 cursor-pointer"> </button></div></form></div></div>'),Yr=m("<li> </li>"),Zr=m('<div class="mt-2 pt-2 border-t border-yellow-200"><p class="text-xs font-medium text-yellow-700 mb-1"> </p> <ul class="text-xs text-yellow-600 space-y-0.5 max-h-24 overflow-y-auto"></ul></div>'),Hr=m('<div><p>ê°€ì ¸ì˜¤ê¸° ê²°ê³¼</p> <div class="grid grid-cols-2 gap-1 text-xs"><span class="text-gray-600">í€˜ìŠ¤íŠ¸ ìƒì„±:</span> <span class="font-medium"> </span> <span class="text-gray-600">í€˜ìŠ¤íŠ¸ ê°±ì‹ :</span> <span class="font-medium"> </span> <span class="text-gray-600">ì ìˆ˜ ìƒì„±:</span> <span class="font-medium"> </span> <span class="text-gray-600">ì ìˆ˜ ê°±ì‹ :</span> <span class="font-medium"> </span></div> <!></div>'),Jr=m('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40"><div class="bg-white rounded-xl shadow-xl w-full max-w-lg mx-4 p-6"><h2 class="text-lg font-bold text-gray-800 mb-1">ğŸ“¥ ì‹œíŠ¸ì—ì„œ í€˜ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°</h2> <p class="text-xs text-gray-500 mb-4">Google ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì˜ "í€˜ìŠ¤íŠ¸" ì‹œíŠ¸ì—ì„œ í€˜ìŠ¤íŠ¸ ëª©ë¡ê³¼ ì ìˆ˜ë¥¼ ìë™ìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.</p> <div class="space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">ìŠ¤í”„ë ˆë“œì‹œíŠ¸ URL ë˜ëŠ” ID</label> <input type="text" placeholder="https://docs.google.com/spreadsheets/d/... ë˜ëŠ” ID" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">ì‹œíŠ¸ ì´ë¦„</label> <input type="text" placeholder="í€˜ìŠ¤íŠ¸" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500"/> <p class="text-xs text-gray-400 mt-1">ê¸°ë³¸ê°’: "í€˜ìŠ¤íŠ¸"</p></div> <!> <div class="flex gap-2 pt-2"><button type="button" class="flex-1 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 cursor-pointer"> </button> <button type="button" class="flex-1 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 disabled:opacity-50 cursor-pointer"> </button></div></div></div></div>'),Xr=m('<div class="max-w-[1600px] mx-auto px-3 py-6 sm:px-6"><div class="mb-6"><button class="text-sm text-blue-600 hover:text-blue-800 mb-2 cursor-pointer">â† ê³¼ì • ëª©ë¡</button> <h1 class="text-2xl font-bold text-gray-800">í€˜ìŠ¤íŠ¸ ê´€ë¦¬</h1></div> <div class="space-y-6"><div class="flex-1 min-w-0"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-4"><h2 class="text-lg font-semibold text-gray-700">í•™ìƒ x í€˜ìŠ¤íŠ¸ ì ìˆ˜í‘œ</h2> <div class="flex flex-col sm:flex-row gap-2"><button class="px-3 py-2 text-sm border border-green-600 text-green-700 rounded-lg hover:bg-green-50 transition-colors cursor-pointer">ğŸ“¥ ì‹œíŠ¸ì—ì„œ ê°€ì ¸ì˜¤ê¸°</button> <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer">+ í€˜ìŠ¤íŠ¸ ì¶”ê°€</button></div></div> <div class="border border-gray-300 bg-white overflow-hidden mb-3"><div class="overflow-auto"><table class="w-full min-w-[980px] text-sm border-collapse"><thead class="bg-gray-100"><tr><th class="sticky left-0 z-20 bg-gray-100 px-1 py-1 text-center font-semibold text-gray-700 min-w-[112px] border-r border-b border-gray-300">í•™ìƒ</th><!><th class="px-1 py-1 text-center min-w-[60px] border-b border-gray-300"><button class="w-8 h-8 rounded-md border border-dashed border-gray-300 text-gray-500 hover:text-blue-600 hover:border-blue-400 cursor-pointer">+</button></th><th class="sticky right-0 z-20 bg-gray-100 px-2 py-1 text-center font-semibold text-gray-700 min-w-[92px] border-l border-b border-gray-300">ì´í•©</th></tr></thead><tbody><!></tbody></table></div></div> <!></div> <div class="w-full"><h2 class="text-lg font-semibold text-gray-700 mb-4">ë¹„ì •ê·œ ì ìˆ˜ ê´€ë¦¬</h2> <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 items-start"><div class="bg-white rounded-lg border border-gray-200 p-4"><h3 class="text-sm font-medium text-gray-700 mb-3">ë¹„ì •ê·œ ì ìˆ˜ ë¶€ì—¬</h3> <div class="space-y-3"><div><label class="block text-xs text-gray-500 mb-1">í•™ìƒ</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"><option>í•™ìƒ ì„ íƒ</option><!></select></div> <div class="flex flex-col sm:flex-row gap-3"><div class="w-20"><label class="block text-xs text-gray-500 mb-1">ì ìˆ˜</label> <input type="number" step="0.5" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> <div class="flex-1 space-y-2"><div><label class="block text-xs text-gray-500 mb-1">ì¹´í…Œê³ ë¦¬</label> <select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></select></div> <!> <div><input type="text" placeholder="ìƒì„¸ ì‚¬ìœ  (ì„ íƒ)" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/></div></div></div> <button class="w-full px-4 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors cursor-pointer"> </button></div></div> <!></div></div> <!></div></div> <!> <!>',1);function xa(c,N){Sr(N,!0);const re=()=>Mr(Cr,"$isLoggedIn",U),[U,Y]=Nr();let B=u(!0),P=u(V([])),h=Mt(()=>qr.params.courseId),ae=u(!1),oe=u(V({}));const it=new Map;let Z=Mt(()=>[...e(P)].sort((t,r)=>t.quest_number-r.quest_number));function xe(t,r){return`${t}:${r}`}function F(t,r){return e(oe)[xe(t,r)]||{score:"",isSubmitted:!1,saving:!1,error:!1}}function _e(t,r,n){const i=xe(t,r);l(oe,{...e(oe),[i]:{...F(t,r),...n}},!0)}function Ct(t,r,n){if(!n||t.trim()==="")return"bg-slate-50 text-slate-500";const i=Number(t);return Number.isNaN(i)?"bg-slate-50 text-slate-500":r==="sub"?i<=0?"bg-red-50 text-red-700":i<.5?"bg-amber-50 text-amber-700":i<1?"bg-lime-50 text-lime-700":"bg-emerald-100 text-emerald-800":r==="main"?i<=0?"bg-red-50 text-red-700":i<2?"bg-orange-50 text-orange-700":i<3?"bg-amber-50 text-amber-700":i<4?"bg-lime-50 text-lime-700":i<5?"bg-emerald-50 text-emerald-700":"bg-indigo-100 text-indigo-800":r==="datathon"?i<=0?"bg-red-50 text-red-700":i<4?"bg-amber-50 text-amber-700":i<7?"bg-lime-50 text-lime-700":"bg-emerald-100 text-emerald-800":i<=0?"bg-red-50 text-red-700":i<8?"bg-amber-50 text-amber-700":i<14?"bg-lime-50 text-lime-700":"bg-emerald-100 text-emerald-800"}function Dt(t){let r=0;for(const n of e(Z)){const i=F(t,n.id);if(!i.isSubmitted)continue;const d=Number(i.score);Number.isNaN(d)||(r+=d)}return r}function Qt(t){const r=Dt(t);return Number.isInteger(r)?String(r):r.toFixed(1)}let le=u(!1),me=u(!1),ie=u(1),ne=u("main"),de=u(""),ue=u(V(new Date().toISOString().split("T")[0])),H=u(null),It=u(V(new Set)),Ne=u(!1),ce=u(""),ye=u("í€˜ìŠ¤íŠ¸"),he=u(!1),$=u(null),nt=u(V([])),we=u(V([])),Rt=u(V([])),Me=u(V([])),qe=u(!1),ve=u(null),be=u(0),se=u("í¼ì‹¤ì¬ëŸ‰ì ìˆ˜"),Se=u(""),$e=u(""),ke=u(!1);const zt=["í¼ì‹¤ì¬ëŸ‰ì ìˆ˜","ì•„ë‚Œì—†ì´ ì£¼ëŠ” ê·¸ë£¨","ë””ìŠ¤ì½”ë“œ ì†Œí†µì™•","ì‰ë°¸ê·¸íˆ¬","ì§ì ‘ ì…ë ¥"];fr(async()=>{if(!re()){st(`${ot}/login`);return}E.post(`/api/v1/admin/sync/students/${e(h)}`).catch(()=>{}),await Ce(),await Et(),await De(),await Qe()});async function Ce(){l(B,!0);try{l(P,await E.get(`/api/v1/facilitator/courses/${e(h)}/quests`),!0),l(It,new Set,!0)}catch{S("í€˜ìŠ¤íŠ¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error")}finally{l(B,!1)}}async function Et(){try{const[t,r]=await Promise.all([E.get(`/api/v1/facilitator/courses/${e(h)}/students?active=true`),E.get(`/api/v1/facilitator/courses/${e(h)}/students?active=false`)]);l(we,t,!0),l(Rt,r,!0),l(nt,t,!0)}catch{}}async function De(){if(e(Z).length===0||e(we).length===0){l(oe,{},!0);return}l(ae,!0);try{const t={};await Promise.all(e(Z).map(async r=>{const n=await E.get(`/api/v1/facilitator/quests/${r.id}/students`);for(const i of n)e(we).find(d=>d.legacy_user_id===i.legacy_student_id)&&(t[xe(i.legacy_student_id,r.id)]={score:i.score===null?"":String(i.score),isSubmitted:i.is_submitted,saving:!1,error:!1})})),l(oe,t,!0)}catch{S("ì ìˆ˜ ë§¤íŠ¸ë¦­ìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.","error")}finally{l(ae,!1)}}function Bt(t,r,n){const i=n.trim();i!==""&&!/^\d+(\.\d+)?$/.test(i)||(_e(t,r.id,{score:i,isSubmitted:i!=="",error:!1}),Ot(t,r.id,r.quest_type))}function Ot(t,r,n){const i=xe(t,r),d=it.get(i);d&&clearTimeout(d),it.set(i,setTimeout(()=>{Ut(t,r)},450))}async function Ut(t,r,n){const i=F(t,r);_e(t,r,{saving:!0,error:!1});try{const d=i.score===""?null:Number(i.score);await E.post(`/api/v1/facilitator/quests/${r}/scores`,{scores:[{legacy_student_id:t,score:d,is_submitted:d!==null}]}),_e(t,r,{saving:!1,error:!1,isSubmitted:d!==null})}catch{_e(t,r,{saving:!1,error:!0}),S("ì ìˆ˜ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}}async function Qe(){l(qe,!0);try{l(Me,await E.get(`/api/v1/facilitator/courses/${e(h)}/bonus-scores`),!0)}catch{S("ë¹„ì •ê·œ ì ìˆ˜ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error")}finally{l(qe,!1)}}async function jt(){let t=e(se);if(e(se)==="ì§ì ‘ ì…ë ¥"&&(t=e(Se).trim()),!e(ve)||e(be)<=0||!t){S("í•™ìƒ, ì ìˆ˜, ì¹´í…Œê³ ë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.","error");return}l(ke,!0);try{await E.post(`/api/v1/facilitator/courses/${e(h)}/bonus-scores`,{legacy_student_id:e(ve),score:e(be),category:t,reason:e($e).trim()}),S("ë¹„ì •ê·œ ì ìˆ˜ê°€ ë¶€ì—¬ë˜ì—ˆìŠµë‹ˆë‹¤.","success"),l(ve,null),l(be,0),l($e,""),l(se,"í¼ì‹¤ì¬ëŸ‰ì ìˆ˜"),l(Se,""),await Qe()}catch{S("ë¹„ì •ê·œ ì ìˆ˜ ë¶€ì—¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{l(ke,!1)}}async function At(t){if(confirm("ì´ ë¹„ì •ê·œ ì ìˆ˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{await E.del(`/api/v1/facilitator/bonus-scores/${t}`),S("ë¹„ì •ê·œ ì ìˆ˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.","success"),await Qe()}catch{S("ë¹„ì •ê·œ ì ìˆ˜ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}}function Pt(t){const r=t.match(/\/spreadsheets\/d\/([a-zA-Z0-9_-]+)/);return r?r[1]:t.trim()}function Ft(){l(ce,""),l(ye,"í€˜ìŠ¤íŠ¸"),l($,null),l(Ne,!0)}async function Gt(){const t=Pt(e(ce));if(!t){S("ìŠ¤í”„ë ˆë“œì‹œíŠ¸ URL ë˜ëŠ” IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.","error");return}l(he,!0),l($,null);try{const r=await E.post(`/api/v1/facilitator/courses/${e(h)}/import-sheet`,{spreadsheet_id:t,sheet_name:e(ye).trim()||"í€˜ìŠ¤íŠ¸"});l($,r,!0),S(`ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ: í€˜ìŠ¤íŠ¸ ${r.quests_created}ê°œ ìƒì„±, ${r.quests_updated}ê°œ ê°±ì‹  / ì ìˆ˜ ${r.scores_created}ê°œ ìƒì„±, ${r.scores_updated}ê°œ ê°±ì‹ `,r.errors.length>0?"error":"success"),await Ce(),await De()}catch{S("ì‹œíŠ¸ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{l(he,!1)}}function dt(){l(H,null),l(ie,e(P).length>0?Math.max(...e(P).map(t=>t.quest_number))+1:1,!0),l(ne,"main"),l(de,""),l(ue,new Date().toISOString().split("T")[0],!0),l(le,!0)}function Kt(t){l(H,t,!0),l(ie,t.quest_number,!0),l(ne,t.quest_type,!0),l(de,t.title||"",!0),l(ue,t.quest_date,!0),l(le,!0)}async function Vt(){l(me,!0);try{const t={quest_number:e(ie),quest_type:e(ne),title:e(de).trim()||null,quest_date:e(ue)};e(H)?(await E.put(`/api/v1/facilitator/quests/${e(H).id}`,t),S("í€˜ìŠ¤íŠ¸ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.","success")):(await E.post(`/api/v1/facilitator/courses/${e(h)}/quests`,t),S("í€˜ìŠ¤íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.","success")),l(le,!1),await Ce(),await De()}catch{S(e(H)?"í€˜ìŠ¤íŠ¸ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.":"í€˜ìŠ¤íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.","error")}finally{l(me,!1)}}var ut=Xr(),Ie=fe(ut),Re=s(Ie),Wt=s(Re);Wt.__click=()=>st(`${ot}/facilitator`),tt(2),a(Re);var ct=o(Re,2),ze=s(ct),Ee=s(ze),vt=o(s(Ee),2),bt=s(vt);bt.__click=Ft;var Yt=o(bt,2);Yt.__click=dt,a(vt),a(Ee);var Be=o(Ee,2),pt=s(Be),ft=s(pt),Oe=s(ft),gt=s(Oe),xt=o(s(gt));ee(xt,17,()=>e(Z),te,(t,r)=>{var n=Rr(),i=s(n),d=s(i);d.__click=()=>Kt(e(r));var b=s(d,!0);a(d),a(i),a(n),D(()=>g(b,e(r).title||`${Dr[e(r).quest_type]} #${e(r).quest_number}`)),v(t,n)});var _t=o(xt),Zt=s(_t);Zt.__click=dt,a(_t),tt(),a(gt),a(Oe);var mt=o(Oe),Ht=s(mt);{var Jt=t=>{var r=zr(),n=s(r);a(r),D(()=>rt(n,"colspan",e(Z).length+3)),v(t,r)},Xt=t=>{var r=Te(),n=fe(r);{var i=b=>{var p=Er(),I=s(p);rt(I,"colspan",3),a(p),v(b,p)},d=b=>{var p=Te(),I=fe(p);ee(I,17,()=>e(we),te,(O,x)=>{var R=jr(),f=s(R),k=s(f);k.__click=()=>st(`${ot}/student/${e(h)}?student_id=${e(x).legacy_user_id}`);var M=s(k,!0);a(k),a(f);var j=o(f);ee(j,17,()=>e(Z),te,(q,y)=>{var L=Ur(),A=s(L),T=s(A);G(T),T.__input=C=>Bt(e(x).legacy_user_id,e(y),C.currentTarget.value);var w=o(T,4);{var J=C=>{var K=Br();v(C,K)},Ye=C=>{var K=Te(),Ze=fe(K);{var He=X=>{var pe=Or();v(X,pe)};Q(Ze,X=>{F(e(x).legacy_user_id,e(y).id).error&&X(He)},!0)}v(C,K)};Q(w,C=>{F(e(x).legacy_user_id,e(y).id).saving?C(J):C(Ye,!1)})}a(A),a(L),D((C,K)=>{Tr(T,C),at(T,1,K)},[()=>F(e(x).legacy_user_id,e(y).id).score,()=>`w-full h-7 px-1 py-0 text-center border-0 rounded-none text-xs font-semibold cursor-text transition-colors duration-100 hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-300 focus:bg-white ${Ct(F(e(x).legacy_user_id,e(y).id).score,e(y).quest_type,F(e(x).legacy_user_id,e(y).id).isSubmitted)} ${F(e(x).legacy_user_id,e(y).id).error?"bg-red-100 text-red-800":""}`]),v(q,L)});var _=o(j,2),z=s(_,!0);a(_),a(R),D(q=>{g(M,e(x).name),g(z,q)},[()=>Qt(e(x).legacy_user_id)]),v(O,R)}),v(b,p)};Q(n,b=>{e(Z).length===0?b(i):b(d,!1)},!0)}v(t,r)};Q(Ht,t=>{e(B)||e(ae)?t(Jt):t(Xt,!1)})}a(mt),a(ft),a(pt),a(Be);var er=o(Be,2);Q(er,t=>{}),a(ze);var Ue=o(ze,2),yt=o(s(Ue),2),je=s(yt),ht=o(s(je),2),Ae=s(ht),Pe=o(s(Ae),2),Fe=s(Pe);Fe.value=(Fe.__value=null)??"";var tr=o(Fe);ee(tr,17,()=>e(nt),te,(t,r)=>{var n=Ar(),i=s(n,!0);a(n);var d={};D(()=>{g(i,e(r).name),d!==(d=e(r).legacy_user_id)&&(n.value=(n.__value=e(r).legacy_user_id)??"")}),v(t,n)}),a(Pe),a(Ae);var Ge=o(Ae,2),Ke=s(Ge),wt=o(s(Ke),2);G(wt),a(Ke);var St=o(Ke,2),Ve=s(St),We=o(s(Ve),2);ee(We,21,()=>zt,te,(t,r)=>{var n=Pr(),i=s(n,!0);a(n);var d={};D(()=>{g(i,e(r)),d!==(d=e(r))&&(n.value=(n.__value=e(r))??"")}),v(t,n)}),a(We),a(Ve);var $t=o(Ve,2);{var rr=t=>{var r=Fr();G(r),W(r,()=>e(Se),n=>l(Se,n)),v(t,r)};Q($t,t=>{e(se)==="ì§ì ‘ ì…ë ¥"&&t(rr)})}var kt=o($t,2),Lt=s(kt);G(Lt),a(kt),a(St),a(Ge);var Le=o(Ge,2);Le.__click=jt;var ar=s(Le,!0);a(Le),a(ht),a(je);var sr=o(je,2);{var or=t=>{Qr(t,{type:"card",lines:3})},lr=t=>{var r=Te(),n=fe(r);{var i=b=>{var p=Gr();v(b,p)},d=b=>{var p=Vr(),I=s(p),O=s(I),x=o(s(O));ee(x,21,()=>e(Me),te,(R,f)=>{var k=Kr(),M=s(k),j=s(M,!0);a(M);var _=o(M),z=s(_);a(_);var q=o(_),y=s(q,!0);a(q);var L=o(q),A=s(L,!0);a(L);var T=o(L),w=s(T);w.__click=()=>At(e(f).id),a(T),a(k),D(J=>{rt(k,"title",`${e(f).given_by_name??""} Â· ${J??""}`),g(j,e(f).student_name),g(z,`+${e(f).score??""}`),g(y,e(f).category),g(A,e(f).reason)},[()=>new Date(e(f).given_at).toLocaleDateString("ko-KR")]),v(R,k)}),a(x),a(O),a(I),a(p),v(b,p)};Q(n,b=>{e(Me).length===0?b(i):b(d,!1)},!0)}v(t,r)};Q(sr,t=>{e(qe)?t(or):t(lr,!1)})}a(yt),a(Ue);var ir=o(Ue,2);Q(ir,t=>{}),a(ct),a(Ie);var Tt=o(Ie,2);{var nr=t=>{var r=Wr(),n=s(r),i=s(n),d=s(i,!0);a(i);var b=o(i,2),p=s(b),I=o(s(p),2);G(I),a(p);var O=o(p,2),x=o(s(O),2),R=s(x);R.value=R.__value="sub";var f=o(R);f.value=f.__value="main";var k=o(f);k.value=k.__value="datathon";var M=o(k);M.value=M.__value="ideathon",a(x),a(O);var j=o(O,2),_=o(s(j),2);G(_),a(j);var z=o(j,2),q=o(s(z),2);G(q),a(z);var y=o(z,2),L=s(y);L.__click=()=>l(le,!1);var A=o(L,2),T=s(A,!0);a(A),a(y),a(b),a(n),a(r),D(()=>{g(d,e(H)?"í€˜ìŠ¤íŠ¸ ìˆ˜ì •":"í€˜ìŠ¤íŠ¸ ì¶”ê°€"),A.disabled=e(me),g(T,e(me)?"ì €ì¥ ì¤‘...":e(H)?"ìˆ˜ì •":"ì¶”ê°€")}),Lr("submit",b,w=>{w.preventDefault(),Vt()}),W(I,()=>e(ie),w=>l(ie,w)),lt(x,()=>e(ne),w=>l(ne,w)),W(_,()=>e(de),w=>l(de,w)),W(q,()=>e(ue),w=>l(ue,w)),v(t,r)};Q(Tt,t=>{e(le)&&t(nr)})}var dr=o(Tt,2);{var ur=t=>{var r=Jr(),n=s(r),i=o(s(n),4),d=s(i),b=o(s(d),2);G(b),a(d);var p=o(d,2),I=o(s(p),2);G(I),tt(2),a(p);var O=o(p,2);{var x=_=>{var z=Hr(),q=s(z),y=o(q,2),L=o(s(y),2),A=s(L);a(L);var T=o(L,4),w=s(T);a(T);var J=o(T,4),Ye=s(J);a(J);var C=o(J,4),K=s(C);a(C),a(y);var Ze=o(y,2);{var He=X=>{var pe=Zr(),Je=s(pe),cr=s(Je);a(Je);var Nt=o(Je,2);ee(Nt,21,()=>e($).errors,te,(vr,br)=>{var Xe=Yr(),pr=s(Xe);a(Xe),D(()=>g(pr,`Â· ${e(br)??""}`)),v(vr,Xe)}),a(Nt),a(pe),D(()=>g(cr,`ì˜¤ë¥˜ (${e($).errors.length??""}ê±´):`)),v(X,pe)};Q(Ze,X=>{e($).errors.length>0&&X(He)})}a(z),D(()=>{at(z,1,`rounded-lg border p-3 ${e($).errors.length>0?"border-yellow-300 bg-yellow-50":"border-green-300 bg-green-50"}`),at(q,1,`text-sm font-medium ${e($).errors.length>0?"text-yellow-800":"text-green-800"} mb-2`),g(A,`${e($).quests_created??""}ê°œ`),g(w,`${e($).quests_updated??""}ê°œ`),g(Ye,`${e($).scores_created??""}ê°œ`),g(K,`${e($).scores_updated??""}ê°œ`)}),v(_,z)};Q(O,_=>{e($)&&_(x)})}var R=o(O,2),f=s(R);f.__click=()=>l(Ne,!1);var k=s(f,!0);a(f);var M=o(f,2);M.__click=Gt;var j=s(M,!0);a(M),a(R),a(i),a(n),a(r),D(_=>{g(k,e($)?"ë‹«ê¸°":"ì·¨ì†Œ"),M.disabled=_,g(j,e(he)?"ê°€ì ¸ì˜¤ëŠ” ì¤‘...":"ê°€ì ¸ì˜¤ê¸°")},[()=>e(he)||!e(ce).trim()]),W(b,()=>e(ce),_=>l(ce,_)),W(I,()=>e(ye),_=>l(ye,_)),v(t,r)};Q(dr,t=>{e(Ne)&&t(ur)})}D(()=>{Le.disabled=e(ke),g(ar,e(ke)?"ë¶€ì—¬ ì¤‘...":"+ ë¶€ì—¬")}),lt(Pe,()=>e(ve),t=>l(ve,t)),W(wt,()=>e(be),t=>l(be,t)),lt(We,()=>e(se),t=>l(se,t)),W(Lt,()=>e($e),t=>l($e,t)),v(c,ut),$r(),Y()}kr(["click","input","change"]);export{xa as component};
